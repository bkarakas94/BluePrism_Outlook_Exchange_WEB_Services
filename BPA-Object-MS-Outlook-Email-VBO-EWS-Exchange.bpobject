<process name="MS Outlook Email VBO - EWS Exchange" version="1.0" bpversion="6.9.0.26970" narrative="" byrefcollection="true" type="object" runmode="Background" preferredid="e9d1f722-19a1-40d7-a381-98f493aab48f">
  <appdef>
    <element name="Application Root">
      <id>7d6f16e8-b8fe-4f4a-be28-53831cf1e442</id>
      <type>Application</type>
      <basetype>Application</basetype>
      <datatype>unknown</datatype>
      <diagnose>False</diagnose>
    </element>
  </appdef>
  <view>
    <camerax>84</camerax>
    <cameray>63</cameray>
    <zoom version="2">1.25</zoom>
  </view>
  <preconditions />
  <endpoint narrative="" />
  <subsheet subsheetid="255da306-efd7-43b7-bf08-c95abe862189" type="CleanUp" published="True">
    <name>Clean Up</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="e7f883d7-e089-45a8-a255-dc0d8166fac1" type="Normal" published="False">
    <name>Configure</name>
    <view>
      <camerax>0</camerax>
      <cameray>-42</cameray>
      <zoom version="2">1.5625</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="c48351e4-96a9-46e5-a4b0-b1eaffa77424" type="Normal" published="True">
    <name>Configure - Simple</name>
    <view>
      <camerax>-30</camerax>
      <cameray>84</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="fea0ef4b-7e57-4cbd-8a3d-ecc86c2d0773" type="Normal" published="True">
    <name>Disconnect</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b017fe03-e78c-4969-9318-6861e6bef92c" type="Normal" published="False">
    <name>Connect</name>
    <view>
      <camerax>168</camerax>
      <cameray>-15</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="dd70aaf7-1d6e-4db3-bd4f-b10531330c36" type="Normal" published="True">
    <name>Add Category</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="a43bb7b1-d15f-4188-936b-c900e5b00931" type="Normal" published="True">
    <name>Check if Mail Exists</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="77750a93-2d14-4b62-9c9c-e285370db11a" type="Normal" published="True">
    <name>Delete Email</name>
    <view>
      <camerax>19</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ed08fe74-8624-4301-99b6-4e17e1fc61cf" type="Normal" published="True">
    <name>Download Attachments By Pattern</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b1e88d5b-90cf-451e-a278-0dd480d19112" type="Normal" published="True">
    <name>Forward Mail</name>
    <view>
      <camerax>-54</camerax>
      <cameray>-63</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="9a7b1d5d-db33-4d77-ab69-a23740b4daa0" type="Normal" published="True">
    <name>Get Received Items</name>
    <view>
      <camerax>71</camerax>
      <cameray>-108</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b2459e92-f403-4dd3-94b4-e2d7df789b0d" type="Normal" published="True">
    <name>Get Received Items - Advanced</name>
    <view>
      <camerax>121</camerax>
      <cameray>-42</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="93537c6e-96da-4960-bb92-f27bb291f13c" type="Normal" published="True">
    <name>Get Default Inbox Folder</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="bc2e7c3f-a6e0-44c5-b68a-21ebf5431264" type="Normal" published="True">
    <name>Get Subfolders List</name>
    <view>
      <camerax>227</camerax>
      <cameray>126</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="544cb7de-1531-4520-a475-9344654901f4" type="Normal" published="False">
    <name>Get Draft Items</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="e46c0ded-deb4-4566-9175-e7773a5adeb4" type="Normal" published="False">
    <name>Update Draft Item HTML</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="f46e4c89-a500-498e-b99a-2a9db676539f" type="Normal" published="True">
    <name>Get Sent Items</name>
    <view>
      <camerax>0</camerax>
      <cameray>-14</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="7652bb6b-74af-46c3-b5f8-327420058668" type="Normal" published="True">
    <name>Get Sent Items - Advanced</name>
    <view>
      <camerax>63</camerax>
      <cameray>-14</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="4dff665c-7cf8-47c3-b0d8-899132c7fc0d" type="Normal" published="True">
    <name>Get Text Body Of Email</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="ba008894-e2af-450a-81d8-b23f6d0652b2" type="Normal" published="True">
    <name>Get Categories XML From Server</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="d0981b19-5d6e-43d2-8300-acf527d2c618" type="Normal" published="True">
    <name>Move Email To Subfolder</name>
    <view>
      <camerax>19</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="f8c75734-aba6-4579-a31b-3b8cf70fe1aa" type="Normal" published="True">
    <name>Copy Email To Subfolder</name>
    <view>
      <camerax>-58</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="d6fbcaa7-665b-4cff-81b7-7e9ef8019b96" type="Normal" published="True">
    <name>Mark Item As Read</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="0cd915a2-53ec-4056-919a-4bc69fe8f0e7" type="Normal" published="True">
    <name>Mark Item As Unread</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b2968ee4-506f-41ee-9637-b9d270c27d9c" type="Normal" published="True">
    <name>Reply Email</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="430ec287-ce54-43a7-bca9-50a133ad4c85" type="Normal" published="True">
    <name>Save Email As File</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="40f338fd-4385-4590-a3c9-4fd3897b91ef" type="Normal" published="True">
    <name>Send Mail</name>
    <view>
      <camerax>240</camerax>
      <cameray>84</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="e8a210c0-bf39-4b8e-88d0-6cdd68c8b632" type="Normal" published="True">
    <name>Send Email Using Template</name>
    <view>
      <camerax>78</camerax>
      <cameray>84</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="86b3c655-bb01-4083-b7f0-85a60402b8cb" type="Normal" published="True">
    <name>Remove Category</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="39c37c2e-c3f0-4632-83de-b7ede20c3e5d" type="Normal" published="True">
    <name>Flag Item Completed</name>
    <view>
      <camerax>42</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="1b8b2338-9a83-40d2-90ba-61567d2c0fb0" type="Normal" published="True">
    <name>Flag Item</name>
    <view>
      <camerax>1</camerax>
      <cameray>-18</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="0d796ae5-30b5-4b4a-aada-b1e14544875a" type="Normal" published="True">
    <name>Flag Item Remove Flags</name>
    <view>
      <camerax>105</camerax>
      <cameray>-21</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="65554530-3120-4a40-a6f7-e23cba6dd55b" type="Normal" published="False">
    <name>Add Signture From HTML (EXPERIMENTAL)</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="800c91fb-147c-4abb-b77e-ada5c6df6202" type="Normal" published="False">
    <name>Filter DataTable</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="bb215801-0055-472d-b487-e7db3041f6c8" type="Normal" published="False">
    <name>Remove Duplciates From DataTable</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b8f093c0-bb02-4888-a792-608bbec62b95" type="Normal" published="False">
    <name>Count Rows Of DataTable</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="01ab113b-e8d7-4c07-8f9b-e7c9ee047ff3" type="Normal" published="False">
    <name>Get User Name</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="5eb459cc-ca99-442b-8aea-dcc949918223" type="Normal" published="True">
    <name>Create Subfolder</name>
    <view>
      <camerax>120</camerax>
      <cameray>72</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <subsheet subsheetid="b0fbedbe-cd8e-404c-9abc-1704e44f6897" type="Normal" published="False">
    <name>Delete Subfolder</name>
    <view>
      <camerax>0</camerax>
      <cameray>0</cameray>
      <zoom version="2">1.25</zoom>
    </view>
  </subsheet>
  <stage stageid="c9bbf84b-6d69-48c9-914d-261d0d5f5151" name="Start" type="Start">
    <loginhibit onsuccess="true" />
    <display x="90" y="-135" />
    <onsuccess>d36fed88-acb6-48dc-adbb-47298be697c7</onsuccess>
  </stage>
  <stage stageid="d36fed88-acb6-48dc-adbb-47298be697c7" name="End" type="End">
    <loginhibit onsuccess="true" />
    <display x="90" y="180" />
  </stage>
  <stage stageid="a358e641-a348-42e8-82a4-fe329bdb051a" name="Stage1" type="ProcessInfo">
    <loginhibit onsuccess="true" />
    <display x="-150" y="-75" w="180" h="150" />
    <font family="Segoe UI" size="11" style="Bold" color="0000FF" />
    <references>
      <reference>System.dll</reference>
      <reference>System.Data.dll</reference>
      <reference>System.Xml.dll</reference>
      <reference>System.Drawing.dll</reference>
      <reference>Microsoft.CSharp.dll</reference>
      <reference>Microsoft.Exchange.WebServices.dll</reference>
    </references>
    <imports>
      <import>System</import>
      <import>System.Drawing</import>
      <import>System.Data</import>
      <import>System.Security.Cryptography.X509Certificates</import>
      <import>System.Collections.Generic</import>
      <import>System.Text</import>
      <import>System.Security</import>
      <import>Microsoft.Exchange.WebServices.Data</import>
      <import>System.Net</import>
      <import>System.Text.RegularExpressions</import>
      <import>System.IO</import>
    </imports>
    <language>csharp</language>
    <globalcode><![CDATA[]]></globalcode>
    <code><![CDATA[ExchangeService exchange = null;

void ConnectEWS(string ewsURL, string _exchangeVersion, string username, string password)
{
	ServicePointManager.ServerCertificateValidationCallback = delegate {return true;} ;

	try
	{
//		exchange				= new ExchangeService(exVer,TimeZoneInfo.Utc);
		// this thing didnt work for me because of stupid timezone assambly bs following line uses the latest version initializes without the args
		exchange				= new ExchangeService();
		exchange.Url			= new Uri(ewsURL);
		exchange.Credentials	= new WebCredentials(username,password);
	}
	catch (Exception ex)
	{
		throw new Exception("failed to initialize exchange object!!="+ex.Message);
	}	
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void SendMailAsSharedMailboxNEW(string subject,string body,string toRecipients, string ccRecipients, string bccRecipients, string[] attachmentsArr,string sharedMailbox,string moveMailToFolderID)
{
	if(exchange == null)
	{	
		throw new Exception("exchange object is null!!");
	}
	EmailMessage message	= new EmailMessage(exchange); 
	message.Subject			= subject;
	message.Body			= body;
	if(string.IsNullOrEmpty(sharedMailbox) == false)
	{		
		message.From			= new EmailAddress(sharedMailbox);
	}
	
	if(toRecipients.Trim() != ""){
		foreach(string rcpt in toRecipients.Replace(";",",").Split(',')){
			message.ToRecipients.Add(rcpt.Trim());
		}
	}
	if(ccRecipients.Trim() != ""){
		foreach(string rcpt in ccRecipients.Replace(";",",").Split(',')){
			message.CcRecipients.Add(rcpt.Trim());
		}
	}
	if(bccRecipients.Trim() != ""){
		foreach(string rcpt in bccRecipients.Replace(";",",").Split(',')){
			message.BccRecipients.Add(rcpt.Trim());
		}
	}
	foreach(string atch in attachmentsArr){
		message.Attachments.AddFileAttachment(atch.Trim());
	}
	//if(string.IsNullOrEmpty(sharedMailbox))
	FolderId destFolderId;
	if(string.IsNullOrEmpty(moveMailToFolderID) == false)
	{
		destFolderId = new FolderId(moveMailToFolderID);
		message.SendAndSaveCopy(destFolderId);	
	}
	else if(string.IsNullOrEmpty(sharedMailbox) == false)
	{
		Mailbox SharedMailbox = new Mailbox(sharedMailbox);
		destFolderId = new FolderId(WellKnownFolderName.SentItems, SharedMailbox);		
		message.SendAndSaveCopy(destFolderId);
		
	}	

	else 
	{
		message.SendAndSaveCopy();		
	}
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
DataTable GetMailsInSpecificFolder(string folderName ,int Maximum_Row,string sharedMailbox,SearchFilter.SearchFilterCollection filterS,bool bodyHTML,string subFolderID)
{
	throwExcIfExchangeIsNull(exchange);
	FolderId destFolderId;
	if(subFolderID.Trim() != "")
	{
		destFolderId = new FolderId(subFolderID);
	}
	else 
	{
		destFolderId = getSpecificFolderID(sharedMailbox, folderName);
	}
//	FolderId destFolderId = getSpecificFolderID(sharedMailbox, folderName);
	PropertySet				itempropertyset	= new PropertySet(BasePropertySet.FirstClassProperties);
	if(bodyHTML==false)
	{
		itempropertyset.RequestedBodyType		= BodyType.Text; //IF YOU INCLUDE THIS THE MAILBODY YOU WILL GET WILL BECOME PLAINTEXT
	}
	
	ItemView				itemview		= new ItemView(Maximum_Row);
	itemview.PropertySet					= itempropertyset;
	
	FindItemsResults<Item>	findResults		= exchange.FindItems(destFolderId, filterS, itemview);
		
	return generateEmailsDataTable(findResults,itempropertyset);
}

DataTable GetSentItems(int Maximum_Row,SearchFilter.SearchFilterCollection filterS,bool bodyHTML)
{	
	if(exchange == null)
	{	
		throw new Exception("exchange object is null!!");
	}
	
	PropertySet				itempropertyset	= new PropertySet(BasePropertySet.FirstClassProperties);
	
	if(bodyHTML==false)
	{
		itempropertyset.RequestedBodyType		= BodyType.Text; //IF YOU INCLUDE THIS THE MAILBODY YOU WILL GET WILL BECOME PLAINTEXT
	}	
	ItemView				itemview		= new ItemView(Maximum_Row);
	itemview.PropertySet					= itempropertyset;
	
	FindItemsResults<Item>	findResults		= exchange.FindItems(WellKnownFolderName.SentItems,filterS, itemview);
	
	return generateEmailsDataTable(findResults,itempropertyset);
}
DataTable GetMailsInSpecificFolderAdvanced(string folderName ,int Maximum_Row,string sharedMailbox,string searchQ,bool bodyHTML)
{
	throwExcIfExchangeIsNull(exchange);
	FolderId destFolderId = getSpecificFolderID(sharedMailbox, folderName);
	PropertySet				itempropertyset	= new PropertySet(BasePropertySet.FirstClassProperties);
	if(bodyHTML==false)
	{
		itempropertyset.RequestedBodyType		= BodyType.Text; //IF YOU INCLUDE THIS THE MAILBODY YOU WILL GET WILL BECOME PLAINTEXT
	}
	
	ItemView				itemview		= new ItemView(Maximum_Row);
	itemview.PropertySet					= itempropertyset;
	
	FindItemsResults<Item>	findResults		= exchange.FindItems(destFolderId, searchQ, itemview);
		
	return generateEmailsDataTable(findResults,itempropertyset);
}
DataTable GetSentItemsAdvanced(int Maximum_Row,string searchQ,bool bodyHTML)
{	
	if(exchange == null)
	{	
		throw new Exception("exchange object is null!!");
	}
	
	PropertySet				itempropertyset	= new PropertySet(BasePropertySet.FirstClassProperties);
	
	if(bodyHTML==false)
	{
		itempropertyset.RequestedBodyType		= BodyType.Text; //IF YOU INCLUDE THIS THE MAILBODY YOU WILL GET WILL BECOME PLAINTEXT
	}	
	ItemView				itemview		= new ItemView(Maximum_Row);
	itemview.PropertySet					= itempropertyset;
	
	FindItemsResults<Item>	findResults		= exchange.FindItems(WellKnownFolderName.SentItems,searchQ, itemview);
	
	return generateEmailsDataTable(findResults,itempropertyset);
}
string getTextBodyOfEmail(string msgid)
{
	PropertySet				itempropertyset	= new PropertySet(BasePropertySet.FirstClassProperties);
	itempropertyset.RequestedBodyType		= BodyType.Text;
	EmailMessage message = EmailMessage.Bind(exchange, new ItemId(msgid),itempropertyset);
	
	return message.Body;
}

void deleteEmail(string msgid,DeleteMode deleteMode)
{
	EmailMessage message = EmailMessage.Bind(exchange, new ItemId(msgid));
	message.Delete(deleteMode);
}

string replyEmail(string msgid, bool replyToAll, string messageText, string[] attachmentsArr)
{
	throwExcIfExchangeIsNull(exchange);
	
	EmailMessage message = EmailMessage.Bind(exchange,msgid, BasePropertySet.IdOnly ); 
	ResponseMessage responseMessage = message.CreateReply(replyToAll);
	
	responseMessage.BodyPrefix = messageText;
	EmailMessage reply = responseMessage.Save();
	
	foreach(string attc in attachmentsArr)
	{
		reply.Attachments.AddFileAttachment(attc);
	}
	reply.Update(ConflictResolutionMode.AutoResolve);
	reply.SendAndSaveCopy();
	return reply.Id.ToString();
}
string forwardMessage(string msgid, string subject,string body,string toRecipients, string ccRecipients, string bccRecipients, string[] attachmentsArr)
{
	throwExcIfExchangeIsNull(exchange);
	
	EmailMessage message = EmailMessage.Bind(exchange,msgid, BasePropertySet.IdOnly ); 
	ResponseMessage responseMessage = message.CreateForward();
	
	responseMessage.BodyPrefix  = body;	
	if(toRecipients.Trim() != ""){
		foreach(string rcpt in toRecipients.Replace(";",",").Split(',')){
			responseMessage.ToRecipients.Add(rcpt.Trim());
		}
	}
	if(ccRecipients.Trim() != ""){
		foreach(string rcpt in ccRecipients.Replace(";",",").Split(',')){
			responseMessage.CcRecipients.Add(rcpt.Trim());
		}
	}
	if(bccRecipients.Trim() != ""){
		foreach(string rcpt in bccRecipients.Replace(";",",").Split(',')){
			responseMessage.BccRecipients.Add(rcpt.Trim());
		}
	}
	EmailMessage fw = responseMessage.Save();

	foreach(string attc in attachmentsArr)
	{
		fw.Attachments.AddFileAttachment(attc);
	}
	fw.Update(ConflictResolutionMode.AutoResolve);
	fw.SendAndSaveCopy();
	return fw.Id.ToString();
}

string moveEmailToFolder(string msgid, string destFolder,string sharedMailbox)
{
	throwExcIfExchangeIsNull(exchange);
	
	PropertySet propSet = new PropertySet(BasePropertySet.IdOnly,EmailMessageSchema.ParentFolderId);
	
	EmailMessage beforeMessage = EmailMessage.Bind(exchange,msgid, propSet); 

	FolderId destFolderId = getSpecificFolderID(sharedMailbox, destFolder);
	if(destFolderId == null)
	{
		throw new Exception("destination folder could not be found!!");
	}
	Item item = beforeMessage.Move(destFolderId);
	
	return item.Id.ToString();
}
void copyEmailToFolder(string msgid, string destFolder,string sharedMailbox)
{
	throwExcIfExchangeIsNull(exchange);
	
	PropertySet propSet = new PropertySet(BasePropertySet.IdOnly,EmailMessageSchema.ParentFolderId);
	
	EmailMessage beforeMessage = EmailMessage.Bind(exchange,msgid, propSet); 

	FolderId destFolderId = getSpecificFolderID(sharedMailbox, destFolder);
	if(destFolderId == null)
	{
		throw new Exception("destination folder could not be found!!");
	}
	Item item = beforeMessage.Copy(destFolderId);	
}


int DownloadAttachmentsByPattern(string msgid, string downloadFolder, string pattern)
{
	int res = 0;
	EmailMessage message = EmailMessage.Bind(exchange, new ItemId(msgid));
	if(message.HasAttachments || !message.HasAttachments)
	{
		res = message.Attachments.Count;
		for (int i = 0; i < message.Attachments.Count; i++)
		{
			FileAttachment fileAttachment = message.Attachments[i] as FileAttachment;
			if(fileAttachment.Name.ToLower().Contains(pattern.ToLower()))
			{
				fileAttachment.Load(@"" + downloadFolder + "\\" + fileAttachment.Name);
			}
			else 
			{
				res--;
			}
		}

	}
	return res;
}

void DownloadMailFile(string msgid, string downloadFolder, string mailFileName)
{
	PropertySet	psPropSet = new PropertySet(EmailMessageSchema.Subject,EmailMessageSchema.MimeContent);
	EmailMessage emailMessage = EmailMessage.Bind(exchange, new ItemId(msgid), psPropSet);
	
	if(mailFileName == "")
	{
		mailFileName=emailMessage.Subject.ToString().Trim() + ".eml";
	}
	else if(mailFileName.EndsWith(".eml")==false)
	{
		mailFileName = mailFileName + ".eml";
	}
	
	FileStream fs = new FileStream(downloadFolder + "\\" + mailFileName , FileMode.Create);
	fs.Write(emailMessage.MimeContent.Content , 0 , emailMessage.MimeContent.Content.Length);
	fs.Close();
}
void addCategoryToMail(string msgid, string category)
{
	throwExcIfExchangeIsNull(exchange);
	
	//EmailMessage message = EmailMessage.Bind(exchange,msgid, BasePropertySet.IdOnly ); // If you bind this way you dont load any properties for the message. You load only the ID Categories Will apper empty
	EmailMessage message = EmailMessage.Bind(exchange,msgid);
	if(message.Categories.Contains(category)==false)
	{
		message.Categories.Add(category);
		message.Update(ConflictResolutionMode.AlwaysOverwrite);
	}
}
void removeCategoryFromMail(string msgid, string category)
{
	throwExcIfExchangeIsNull(exchange);
	
	//EmailMessage message = EmailMessage.Bind(exchange,msgid, BasePropertySet.IdOnly ); // If you bind this way you dont load any properties for the message. You load only the ID Categories Will apper empty
	EmailMessage message = EmailMessage.Bind(exchange,msgid);
	if(message.Categories.Contains(category)==true)
	{
		message.Categories.Remove(category);
		message.Update(ConflictResolutionMode.AlwaysOverwrite);
	}
}
void markMailItemAsRead(string msgid)
{
	throwExcIfExchangeIsNull(exchange);
	
	EmailMessage message = EmailMessage.Bind(exchange,msgid);
	message.IsRead=true;
	message.Update(ConflictResolutionMode.AlwaysOverwrite);
}
void markMailItemAsUnread(string msgid)
{
	throwExcIfExchangeIsNull(exchange);
	
	EmailMessage message = EmailMessage.Bind(exchange,msgid);
	message.IsRead=false;
	message.Update(ConflictResolutionMode.AlwaysOverwrite);
}
void updateMailItemFlag(string msgid,int fStatus,DateTime completed,DateTime dueDateTime)
{
	throwExcIfExchangeIsNull(exchange);
	
	EmailMessage message = EmailMessage.Bind(exchange,msgid);
	if(fStatus==1)
	{
		message.Flag.StartDate = DateTime.Now;
		message.Flag.DueDate=dueDateTime;
	}	
	else if(fStatus==2)
	{
		TimeSpan twoSec = new TimeSpan(0,0,0,2);
		message.Flag.StartDate = completed-twoSec;
		message.Flag.CompleteDate=completed;
	}
	message.Flag.FlagStatus=(ItemFlagStatus)fStatus;
	message.Update(ConflictResolutionMode.AlwaysOverwrite);
}
string getCategoriesUserConfig()
{
	UserConfiguration usrConfig = UserConfiguration.Bind(exchange,"CategoryList",WellKnownFolderName.Calendar,UserConfigurationProperties.All);
	byte[] xmlData = usrConfig.XmlData;
	string xml = Encoding.UTF8.GetString(xmlData);
	return xml;
}

MimeContent readMimeContentOfEMLTemplate(string fPathEML, string preferedEncoding)
{
	throwExcIfExchangeIsNull(exchange);	
	MimeContent rez;
    using (FileStream fs = new FileStream(fPathEML, FileMode.Open, FileAccess.Read))
    {
        byte[] bytes = new byte[fs.Length];
        int numBytesToRead = (int)fs.Length;
        int numBytesRead = 0;
        while (numBytesToRead > 0)
        {
            int n = fs.Read(bytes, numBytesRead, numBytesToRead);
            if (n == 0)
                break;
            numBytesRead += n;
            numBytesToRead -= n;
        }
        // Set the contents of the .eml file to the MimeContent property.
        rez = new MimeContent(preferedEncoding, bytes);
    }	
	return rez;
}
void sendMailUsingEMLTemplate(string fPath ,string toRecipients ,ref DataTable replaceSubject ,ref DataTable replaceBody ,string ccRecipients ,string bccRecipients ,string attachments ,string sharedMailbox,string emlEncoding = "UTF-8")
{
	EmailMessage em	= new EmailMessage(exchange); 
	em.MimeContent = readMimeContentOfEMLTemplate(fPath,emlEncoding);

	foreach(string rcpt in toRecipients.Replace(";",",").Split(','))
	{
		em.ToRecipients.Add(rcpt.Trim());
	}
	if(ccRecipients.Trim() != "")
	{
		foreach(string rcpt in ccRecipients.Replace(";",",").Split(','))
		{
			em.CcRecipients.Add(rcpt.Trim());
		}
	}
	if(bccRecipients.Trim() != "")
	{
		foreach(string rcpt in bccRecipients.Replace(";",",").Split(','))
		{
			em.BccRecipients.Add(rcpt.Trim());
		}
	}
	if(string.IsNullOrEmpty(sharedMailbox))
	{
		em.Save(WellKnownFolderName.Drafts);
	}
	else
	{
		Mailbox SharedMailbox = new Mailbox(sharedMailbox);
		FolderId SharedMailboxDraftItems = new FolderId(WellKnownFolderName.Drafts, SharedMailbox);
		em.Save(SharedMailboxDraftItems);
	}
	EmailMessage mess = EmailMessage.Bind(exchange,em.Id); 
	if(string.IsNullOrEmpty(sharedMailbox) == false)
	{		
		mess.From			= new EmailAddress(sharedMailbox);
	}
	DataTable dtReplaceSubject = createTemplateReplaceDTFromOneRow(ref replaceSubject);	
	for (int i = 0; i < dtReplaceSubject.Rows.Count; i++)
	{
		string replaceThis	= dtReplaceSubject.Rows[i][0].ToString().Trim();
		string withThis		= dtReplaceSubject.Rows[i][1].ToString().Trim();
		mess.Subject=mess.Subject.Replace(replaceThis,withThis);
	}
	DataTable dtReplaceBody = createTemplateReplaceDTFromOneRow(ref replaceBody);	
	for (int i = 0; i < dtReplaceBody.Rows.Count; i++)
	{
		string replaceThis	= dtReplaceBody.Rows[i][0].ToString().Trim();
		string withThis		= dtReplaceBody.Rows[i][1].ToString().Trim();
		MessageBody mb		= mess.Body;
		mb.Text				= mb.Text.Replace(replaceThis,withThis);
		mess.Body			= mb;
	}	

	if(attachments.Trim() != "")
	{
		foreach(string atch in attachments.Split(';'))
		{
			mess.Attachments.AddFileAttachment(atch.Trim());
		}	
	}
	if(string.IsNullOrEmpty(sharedMailbox))
	{
		mess.SendAndSaveCopy();
	}
	else 
	{
		Mailbox SharedMailbox = new Mailbox(sharedMailbox);
		FolderId SharedMailboxSendItems = new FolderId(WellKnownFolderName.SentItems, SharedMailbox);		
		mess.SendAndSaveCopy(SharedMailboxSendItems);		
	}
}

DataTable GetDraftItems(bool bodyHTML)
{	
	if(exchange == null)
	{	
		throw new Exception("exchange object is null!!");
	}
	
	PropertySet				itempropertyset	= new PropertySet(BasePropertySet.FirstClassProperties);
	
	if(bodyHTML==false)
	{
		itempropertyset.RequestedBodyType		= BodyType.Text; //IF YOU INCLUDE THIS THE MAILBODY YOU WILL GET WILL BECOME PLAINTEXT
	}	
	ItemView				itemview		= new ItemView(1500);
	itemview.PropertySet					= itempropertyset;
	
	FindItemsResults<Item>	findResults		= exchange.FindItems(WellKnownFolderName.Drafts,itemview);
	DataTable rez = new DataTable();
	rez.Columns.Add("EntryID",typeof(string));
	rez.Columns.Add("Subject",typeof(string));
	rez.Columns.Add("Body",typeof(string));
	foreach(Item item in findResults)
	{
		EmailMessage m = EmailMessage.Bind(exchange,item.Id,itempropertyset);
		rez.Rows.Add();		
		rez.Rows[rez.Rows.Count-1]["EntryID"]				= m.Id.UniqueId	;
		rez.Rows[rez.Rows.Count-1]["Subject"]				= m.Subject		;
		rez.Rows[rez.Rows.Count-1]["Body"]					= m.Body		;
	}
	return rez;
}
void updateDraftItemHTML(string msgid,string bodyHTML)
{
	throwExcIfExchangeIsNull(exchange);
	
	EmailMessage message = EmailMessage.Bind(exchange,msgid);
	message.Body=bodyHTML;
	message.Update(ConflictResolutionMode.AlwaysOverwrite);
}
void updateDraftItemSubject(string msgid,string subject)
{
	throwExcIfExchangeIsNull(exchange);
	
	EmailMessage message = EmailMessage.Bind(exchange,msgid);
	message.Subject=subject;
	message.Update(ConflictResolutionMode.AlwaysOverwrite);
}

FolderId getSpecificFolderID(string sharedMailbox, string folderName)
{
	FolderId rez=null;
	throwExcIfExchangeIsNull(exchange);	
	DataTable myFolders	= getFullFoldersListAtRoot(sharedMailbox);
	myFolders			= applyFilterToDataTable(ref myFolders,"[Display Name]='"+folderName+"'");
	
	if(myFolders.Rows.Count==1)
	{
		rez = new FolderId(myFolders.Rows[0]["Folder ID"].ToString());
	}
	else
	{
		throw new Exception("Number of folders found for "+folderName+" is not one. There are "+myFolders.Rows.Count.ToString()+" folders that match the criteria");
	}	
	
	return rez;
}
DataTable getFullFoldersListAtRoot(string sharedMailbox)
{
	DataTable dt = new DataTable();
	dt.Columns.Add("Display Name",typeof(string));
	dt.Columns.Add("Folder ID",typeof(string));
	dt.Columns.Add("Parent Folder ID",typeof(string));
	
	throwExcIfExchangeIsNull(exchange);
	FolderView view = new FolderView(2000);		///////IF YOUR MAILBOX HAS MORE SUBFOLDERS THAN 2000 INCREASE THIS NUMBER
	//view.PropertySet	=	 new PropertySet(BasePropertySet.IdOnly);
	view.PropertySet	=	 new PropertySet(BasePropertySet.FirstClassProperties);
	view.PropertySet.Add(FolderSchema.DisplayName);
	view.Traversal	=	FolderTraversal.Deep;
	FindFoldersResults	findFoldersResults;
	if(string.IsNullOrEmpty(sharedMailbox))
	{
		findFoldersResults	=	exchange.FindFolders(WellKnownFolderName.MsgFolderRoot,view);
	}	
	else
	{
		Mailbox	mbox		= new Mailbox(sharedMailbox);
		findFoldersResults	=	exchange.FindFolders(new FolderId(WellKnownFolderName.MsgFolderRoot, mbox), view);
	}	
	
	foreach(Folder f in findFoldersResults)
	{
		dt.Rows.Add(f.DisplayName,f.Id,f.ParentFolderId);
	}
	return dt;
}
Folder getDefaultInboxFolder(string sharedMailbox)
{
	Folder rez;
	if(string.IsNullOrEmpty(sharedMailbox))
	{		
		rez = Folder.Bind(exchange, WellKnownFolderName.Inbox);
	}
	else
	{
		//Mailbox	mbox		= new Mailbox(sharedMailbox);
		//rez = Folder.Bind(exchange, WellKnownFolderName.Inbox,mbox);
		Mailbox mbox = new Mailbox(sharedMailbox);
		FolderId inboxID = new FolderId(WellKnownFolderName.Inbox, mbox);		
		rez = Folder.Bind(exchange, inboxID);
	}
	return rez;
}
void addUpdateSignatureToOWA(string signatureName, string hsHtmlSigniture,bool autoAddSignature)
{
	exchange.TraceEnabled = true;
	Folder Root = Folder.Bind(exchange, WellKnownFolderName.Root);	
	UserConfiguration OWAConfig = UserConfiguration.Bind(exchange, "OWA.UserOptions", Root.ParentFolderId, UserConfigurationProperties.Dictionary);
	string stTextSig = signatureName;//"Geralt Test";

	if(OWAConfig.Dictionary.ContainsKey("signaturehtml"))
	{
		OWAConfig.Dictionary["signaturehtml"]		= hsHtmlSigniture;
		OWAConfig.Dictionary["autoaddsignature"]	= autoAddSignature;
	}
	else
	{
		OWAConfig.Dictionary.Add("signaturehtml", hsHtmlSigniture);
		OWAConfig.Dictionary.Add("autoaddsignature", autoAddSignature);
	}
	if (OWAConfig.Dictionary.ContainsKey("signaturetext"))
	{
		OWAConfig.Dictionary["signaturetext"] = stTextSig;
	}
	else
	{
		OWAConfig.Dictionary.Add("signaturetext", stTextSig);
	}
	OWAConfig.Update();	
}
void createSubfolder(string newfolderName ,string parentFolderName,string parentSubfolderIDSTR,string sharedMailbox)
{
	FolderId parentFolderId;
	if(parentSubfolderIDSTR.Trim() != "")
	{
		parentFolderId = new FolderId(parentSubfolderIDSTR);
	}
	else 
	{
		parentFolderId = getSpecificFolderID(sharedMailbox, parentFolderName);
	}	
	Folder folder = new Folder(exchange);
	folder.DisplayName = newfolderName;
	folder.Save(parentFolderId);
}
	

/////////////////////////////////REUSABLE COMPONENTS//////////////////////////////REUSABLE COMPONENTS//////////////////////////////REUSABLE COMPONENTS//////////////////////////////
void throwExcIfExchangeIsNull(ExchangeService e)
{
	if(e==null)
	{
		throw new Exception("exchange object is null!!");
	}
}
string joinEmailAddresses(EmailAddressCollection rcpColl)
{
	List<string> rcpList	=new List<string>();
	for (int i = 0; i < rcpColl.Count; i++)
	{
		rcpList.Add(rcpColl[i].Address);
	}
	
	return string.Join(";",rcpList.ToArray());
}

string joinAttachmentsColl(AttachmentCollection atcColl)
{
	List<string> atcList =new List<string>();
	for (int i = 0; i < atcColl.Count; i++)
	{
		atcList.Add(atcColl[i].Name);
	}
	
	return string.Join(";",atcList.ToArray());
}

DataTable generateEmailsDataTable(FindItemsResults<Item> findResults,PropertySet itempropertyset)
{
	DataTable dt = new DataTable();
	dt.Columns.Add("EntryID",typeof(string));
	dt.Columns.Add("To",typeof(string));
	dt.Columns.Add("CC",typeof(string));
	dt.Columns.Add("BCC",typeof(string));
	dt.Columns.Add("Subject",typeof(string));
	dt.Columns.Add("Body",typeof(string));
	dt.Columns.Add("Attachments",typeof(string));		
	dt.Columns.Add("ReceivedOn",typeof(DateTime));
	dt.Columns.Add("SentOn",typeof(DateTime));
	dt.Columns.Add("SenderName",typeof(string));
	dt.Columns.Add("SenderEmailAddress",typeof(string));		
	dt.Columns.Add("IsRead",typeof(Boolean));
	dt.Columns.Add("Sensitivity",typeof(Int16));
	dt.Columns.Add("Importance",typeof(Int16));
	dt.Columns.Add("Flag",typeof(string));
	dt.Columns.Add("Categories",typeof(string));
	
	foreach(Item item in findResults)
	{
		EmailMessage m = EmailMessage.Bind(exchange,item.Id,itempropertyset);
		string fromName = "";
		string fromAddr = "";
		try
		{
			fromName = m.From.Name;
			fromAddr = m.From.Address;			
		}
		catch(NullReferenceException)
		{			
		}
		dt.Rows.Add();		
		dt.Rows[dt.Rows.Count-1]["EntryID"]				= m.Id.UniqueId		;
		dt.Rows[dt.Rows.Count-1]["To"]					= joinEmailAddresses(m.ToRecipients);
		dt.Rows[dt.Rows.Count-1]["CC"]					= joinEmailAddresses(m.CcRecipients);
		dt.Rows[dt.Rows.Count-1]["BCC"]					= joinEmailAddresses(m.BccRecipients);
		dt.Rows[dt.Rows.Count-1]["Subject"]				= m.Subject			;
		dt.Rows[dt.Rows.Count-1]["Body"]				= m.Body			;
		dt.Rows[dt.Rows.Count-1]["Attachments"]			= joinAttachmentsColl(m.Attachments);
		dt.Rows[dt.Rows.Count-1]["ReceivedOn"]			= m.DateTimeReceived;
		dt.Rows[dt.Rows.Count-1]["SentOn"]				= m.DateTimeSent	;
		dt.Rows[dt.Rows.Count-1]["SenderName"]			= fromName; //m.From.Name		;
		dt.Rows[dt.Rows.Count-1]["SenderEmailAddress"]	= fromAddr; // m.From.Address	;
		dt.Rows[dt.Rows.Count-1]["IsRead"]				= m.IsRead			;
		dt.Rows[dt.Rows.Count-1]["Sensitivity"]			= m.Sensitivity		;
		dt.Rows[dt.Rows.Count-1]["Importance"]			= m.Importance		;
		dt.Rows[dt.Rows.Count-1]["Flag"]				= m.Flag.FlagStatus	;			
		dt.Rows[dt.Rows.Count-1]["Categories"]			= m.Categories ;
	}	
	
	return dt;
}
DataTable createTemplateReplaceDT(string replaceCSV)
{
	DataTable dt = new DataTable();
	dt.Columns.Add("Replace THIS",typeof(string));
	dt.Columns.Add("WITH This",typeof(string));
	
	string[] csvcontent=replaceCSV.Trim().Split('\n');	
	foreach(string ro in csvcontent)
	{
		dt.Rows.Add(ro.Split('|')[0],ro.Split('|')[1]);
	}
	return dt;
}
DataTable createTemplateReplaceDTFromOneRow(ref DataTable replaceDT)
{
	DataTable dt = new DataTable();
	dt.Columns.Add("Replace THIS",typeof(string));
	dt.Columns.Add("WITH This",typeof(string));
	
	if(replaceDT.Rows.Count>0 && replaceDT.Columns.Count>0)
	{
		for (int j = 0; j < replaceDT.Columns.Count; j++)
		{
			if(string.IsNullOrEmpty(replaceDT.Rows[0][j].ToString())==false)			
			{
				dt.Rows.Add(replaceDT.Columns[j].ColumnName,replaceDT.Rows[0][j].ToString());
			}
		}

	}	
	return dt;
}

DataTable applyFilterToDataTable(ref DataTable dt, string filter)
{
	DataView dv = new DataView(dt);
	dv.RowFilter = filter; 	
	return dv.ToTable();
}]]></code>
  </stage>
  <stage stageid="862d19d3-a3d9-463d-8655-ecedf0a6f34d" name="Clean Up" type="SubSheetInfo">
    <subsheetid>255da306-efd7-43b7-bf08-c95abe862189</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="ff80793f-48db-4282-8ae5-a9dd7a492b57" name="Start" type="Start">
    <subsheetid>255da306-efd7-43b7-bf08-c95abe862189</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" />
    <onsuccess>122127db-f789-4381-8483-66195cdbe16f</onsuccess>
  </stage>
  <stage stageid="122127db-f789-4381-8483-66195cdbe16f" name="End" type="End">
    <subsheetid>255da306-efd7-43b7-bf08-c95abe862189</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="90" />
  </stage>
  <stage stageid="4ab5a444-714e-4cee-8ffa-a678c57ea98f" name="Send Mail" type="SubSheetInfo">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-135" w="180" h="30" />
  </stage>
  <stage stageid="f1cd9f62-9e3e-42ad-930c-82151e458d18" name="Start" type="Start">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="-135" />
    <inputs>
      <input type="text" name="To" stage="To" />
      <input type="text" name="CC" narrative="OPTIONAL" stage="CC" />
      <input type="text" name="BCC" narrative="OPTIONAL" stage="BCC" />
      <input type="text" name="Subject" stage="Subject" />
      <input type="text" name="Message" stage="Message" />
      <input type="text" name="Attachments" narrative="OPTIONAL" stage="Attachments" />
      <input type="text" name="Shared Mailbox (Send As)" narrative="OPTIONAL" stage="Shared Mailbox" />
      <input type="text" name="Folder To Save Sent Item" narrative="OPTIONAL" stage="Folder To Save Sent Item" />
    </inputs>
    <onsuccess>a079aa41-a7f8-4549-8a02-689e8ddd0c05</onsuccess>
  </stage>
  <stage stageid="13e584bf-3375-4621-9522-c2cf068fd72a" name="Note1" type="Note">
    <loginhibit onsuccess="true" />
    <narrative>email.From = new EmailAddress("smtpaddress@domain.com"); 
Mailbox SharedMailbox = new Mailbox("smtpaddress@domain.com");
FolderId SharedMailboxSendItems = new FolderId(WellKnownFolderName.SentItems, SharedMailbox);
email.SendAndSaveCopy(SharedMailboxSendItems);

https://stackoverflow.com/questions/44639791/sending-email-using-ews-in-c-sharp-from-shared-mailbox


</narrative>
    <display x="465" y="-15" w="120" h="270" />
  </stage>
  <stage stageid="21e290cc-a588-4f61-a79b-6973a0178ef6" name="Note2" type="Note">
    <loginhibit onsuccess="true" />
    <narrative>https://learn.microsoft.com/en-us/dotnet/api/microsoft.exchange.webservices.data.exchangeservice?view=exchange-ews-api
https://learn.microsoft.com/en-us/dotnet/api/system.timezoneinfo.converttime?view=net-7.0
</narrative>
    <display x="330" y="-45" w="90" h="210" />
  </stage>
  <stage stageid="f408826b-b40a-4b57-9159-b710a4f69fd6" name="Get Received Items" type="SubSheetInfo">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-405" w="180" h="30" />
  </stage>
  <stage stageid="17ee6e0c-94f6-41e2-8db4-a4913b594562" name="Start" type="Start">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-345" />
    <inputs>
      <input type="text" name="Subfolder" narrative="Can be Pipe Seperated ( | )" stage="Subfolder" />
      <input type="text" name="Subfolder ID" stage="Subfolder ID" />
      <input type="number" name="Max Result Count" stage="Max Result Count" />
      <input type="datetime" name="Earliest Received DateTime" stage="Earliest Received DateTime" />
      <input type="text" name="Shared Mailbox" stage="Shared Mailbox" />
      <input type="text" name="Subject Contains" stage="Subject Contains" />
      <input type="text" name="Body Contains" stage="Body Contains" />
      <input type="text" name="Include Read" narrative="true or false" stage="Include Read" />
      <input type="text" name="Sender Mail Address" stage="Sender Mail Address" />
      <input type="flag" name="HTML Body ?" stage="HTML Body?" />
    </inputs>
    <onsuccess>9e9886de-2d1d-40d7-9ffd-8ed0b4f03afa</onsuccess>
  </stage>
  <stage stageid="a7d65de1-7f7d-4c2a-98cf-72fef074d1e3" name="End" type="End">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="150" />
    <outputs>
      <output type="collection" name="Received Items" stage="Received Items" />
      <output type="number" name="RowCount-Received Items" stage="RowCount-Received Items" />
    </outputs>
  </stage>
  <stage stageid="89c5efff-b4d7-49c0-a02d-90d33e227f1d" name="Configure" type="SubSheetInfo">
    <subsheetid>e7f883d7-e089-45a8-a255-dc0d8166fac1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-120" w="150" h="30" />
  </stage>
  <stage stageid="de5653a2-f4c6-4554-a62b-9309a73d1d9d" name="Start" type="Start">
    <subsheetid>e7f883d7-e089-45a8-a255-dc0d8166fac1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="Mail Username" stage="_EWS Mail Username" />
      <input type="password" name="Password" stage="_Password" />
      <input type="text" name="Exchange Version" stage="_Exchange Version" />
      <input type="text" name="URL-EWS Server" stage="_URL-EWS Server" />
    </inputs>
    <onsuccess>f9df43a4-1647-4abf-a00a-a963f1751bfe</onsuccess>
  </stage>
  <stage stageid="9cb77807-33c2-4481-971c-9449948d7ef3" name="End" type="End">
    <subsheetid>e7f883d7-e089-45a8-a255-dc0d8166fac1</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" />
  </stage>
  <stage stageid="a7f64da8-e20a-45a7-920b-0f27d65307d9" name="_URL-EWS Server" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-150" y="45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
  </stage>
  <stage stageid="b3a1e8f4-3602-4731-823b-11c41d128915" name="_Exchange Version" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-150" y="75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">Exchange2013_SP1</initialvalue>
  </stage>
  <stage stageid="5850202a-c8de-45cb-9b40-8d3a9dec5bd7" name="_EWS Mail Username" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-150" y="105" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
  </stage>
  <stage stageid="50d5c2a8-5b0f-4572-9679-e20c45ba016c" name="_Password" type="Data">
    <loginhibit onsuccess="true" />
    <display x="-150" y="135" w="180" h="30" />
    <datatype>password</datatype>
    <initialvalueenc>
    </initialvalueenc>
  </stage>
  <stage stageid="9a78d56a-2d17-490f-a8c9-025b3d338468" name="PARAMS" type="Block">
    <loginhibit onsuccess="true" />
    <display x="-240" y="15" w="180" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="5faceb1a-4916-42ec-906d-8ecaa0063e6b" name="To" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d03cb60a-4fd3-4d23-b43b-a2a044f220c2" name="INPUTS" type="Block">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="-105" w="180" h="285" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="5361e5bb-d553-47d9-a342-6ac6811377b6" name="CC" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9efdfc94-2ef3-42f7-8cd6-07e600c96bd2" name="BCC" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="79aeed04-4019-4613-9906-39b213bc339e" name="Subject" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d3383092-2c2e-48b4-a260-ef2e7a9c30f8" name="Message" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2da0966b-0c2a-442b-93b2-3b9447694dda" name="Attachments" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a7036a92-feff-4d64-b9d2-dfc43b5f3016" name="Connect" type="SubSheetInfo">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="0" w="150" h="30" />
  </stage>
  <stage stageid="031f8053-63a6-49b3-851f-0f2b4b4ab60b" name="Start" type="Start">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" />
    <onsuccess>6feebf87-991e-4326-b320-7019ade60c9d</onsuccess>
  </stage>
  <stage stageid="70fb781b-8c8d-48e8-a943-6e3ef5f19204" name="End" type="End">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="135" />
  </stage>
  <stage stageid="8cfd6d36-2032-406d-8a61-abd073451f10" name="establishConnection" type="Code">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="90" w="120" h="30" />
    <inputs>
      <input type="text" name="myURL" expr="[_URL-EWS Server]" />
      <input type="text" name="exchangeVer" expr="[_Exchange Version]" />
      <input type="text" name="userName" expr="[_EWS Mail Username]" />
      <input type="password" name="myPassword" expr="[_Password]" />
    </inputs>
    <onsuccess>70fb781b-8c8d-48e8-a943-6e3ef5f19204</onsuccess>
    <code><![CDATA[//ConnectEWS(string ewsURL, string _exchangeVersion, string username, string password)
ConnectEWS(myURL,exchangeVer,userName,myPassword);]]></code>
  </stage>
  <stage stageid="6feebf87-991e-4326-b320-7019ade60c9d" name="URL Is NOT Missing?" type="Decision">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <decision expression="Len(Trim([_URL-EWS Server]))&gt;0" />
    <ontrue>63d1cc04-78b6-4f5b-8709-9df82d42b17a</ontrue>
    <onfalse>be8d423d-abbf-4247-9748-9f6896065cce</onfalse>
  </stage>
  <stage stageid="63d1cc04-78b6-4f5b-8709-9df82d42b17a" name="Mail Address Is NOT Missing?" type="Decision">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="120" h="30" />
    <decision expression="Len(Trim([_EWS Mail Username]))&gt;0" />
    <ontrue>40cb3857-6619-4e2e-95eb-64b49170aae0</ontrue>
    <onfalse>be8d423d-abbf-4247-9748-9f6896065cce</onfalse>
  </stage>
  <stage stageid="40cb3857-6619-4e2e-95eb-64b49170aae0" name="Password Is NOT Missing?" type="Decision">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <decision expression="Len(Trim([_Password]))&gt;0" />
    <ontrue>8cfd6d36-2032-406d-8a61-abd073451f10</ontrue>
    <onfalse>be8d423d-abbf-4247-9748-9f6896065cce</onfalse>
  </stage>
  <stage stageid="f9df43a4-1647-4abf-a00a-a963f1751bfe" name="Note3" type="Note">
    <subsheetid>e7f883d7-e089-45a8-a255-dc0d8166fac1</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>ASSIGNS THE PARAMETERS IN INITIALISE PAGE</narrative>
    <display x="15" y="-60" w="210" h="30" />
    <font family="Segoe UI" size="14" style="Bold" color="FF0000" />
    <onsuccess>9cb77807-33c2-4481-971c-9449948d7ef3</onsuccess>
  </stage>
  <stage stageid="eb974122-234b-4f3e-ac8d-4c0d75c406ce" name="Received Items" type="Collection">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="120" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9e9886de-2d1d-40d7-9ffd-8ed0b4f03afa" name="Connect" type="SubSheet">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-300" w="90" h="30" />
    <onsuccess>3179e8d9-8539-44d3-be5d-e4c40b9f7d70</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="fb1179ca-5d45-4032-94c2-d6aa8af344c1" name="OUTPUTS" type="Block">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="90" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="618d1a01-6498-446d-a2fb-725569ac2370" name="RowCount-Received Items" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="150" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1a7584f3-4bbf-4cf4-933f-dc90171627d8" name="INPUTS" type="Block">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-375" w="180" h="345" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="84c782c3-0002-4d73-a171-9834e23f20ee" name="Subfolder" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-120" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0e1d6b76-43f9-4861-8d05-57fe4f30b135" name="Max Result Count" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-90" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue>99</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6305b4ae-7b91-48f1-a17e-8a16175e5adf" name="Earliest Received DateTime" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-60" w="180" h="30" />
    <datatype>datetime</datatype>
    <initialvalue>2000-01-01 00:00:00Z</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="eaeee730-5db4-419a-9f58-37b0fe7b204a" name="Download Attachments By Pattern" type="SubSheetInfo">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-120" w="180" h="30" />
  </stage>
  <stage stageid="d4097769-e374-4790-9ec6-b4d3f38fa582" name="Start" type="Start">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
      <input type="text" name="Folder Path" stage="Folder Path" />
      <input type="text" name="File Pattern" narrative="Default value is single dot which downloads everything" stage="File Pattern" />
    </inputs>
    <onsuccess>884a331c-6a36-4f03-8efb-ee806379f43b</onsuccess>
  </stage>
  <stage stageid="0003d180-b44d-47d2-af76-4b584ecdcabf" name="End" type="End">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="60" />
  </stage>
  <stage stageid="a1f09a9f-5461-496a-b992-41103ef0d6a2" name="downloadMyAttachmentsByPattern" type="Code">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="15" w="150" h="30" />
    <inputs>
      <input type="text" name="eid" expr="[EntryID]" />
      <input type="text" name="folderPath" expr="[Folder Path]" />
      <input type="text" name="filePattern" expr="[File Pattern]" />
    </inputs>
    <outputs>
      <output type="number" name="fcount" stage="Downloaded Attachments Count" />
    </outputs>
    <onsuccess>0003d180-b44d-47d2-af76-4b584ecdcabf</onsuccess>
    <code><![CDATA[int rez = 0;
//DownloadAttachmentsByPattern(string msgid, string downloadFolder, string pattern)

rez = DownloadAttachmentsByPattern(eid , folderPath , filePattern);

fcount = rez;]]></code>
  </stage>
  <stage stageid="ebf6a616-1a6d-48e4-a2ed-d6d9bc9d2965" name="EntryID" type="Data">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8cb5031c-4379-4c63-a52b-c47f51b49ea4" name="INPUTS" type="Block">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="-90" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="967c7438-4e6c-44de-ad2a-7c5f9e299efc" name="Folder Path" type="Data">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="87519d2c-94b6-44c7-83dd-90c95e188431" name="File Pattern" type="Data">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Fiile name contains this</narrative>
    <display x="-225" y="0" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">.</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e942338f-209d-4cb5-86d9-92405fd98623" name="Downloaded Attachments Count" type="Data">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="75" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2d40219a-85a5-4ba3-b1bc-e8b4bf2399e3" name="OUTPUTS" type="Block">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="45" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="884a331c-6a36-4f03-8efb-ee806379f43b" name="Connect" type="SubSheet">
    <subsheetid>ed08fe74-8624-4301-99b6-4e17e1fc61cf</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-30" w="120" h="30" />
    <onsuccess>a1f09a9f-5461-496a-b992-41103ef0d6a2</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="f05cfc10-5439-4776-bb25-abd85b40c4c8" name="Save Email As File" type="SubSheetInfo">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-75" w="180" h="30" />
  </stage>
  <stage stageid="b14cfa75-28a9-459d-9f00-184572af29ac" name="Start" type="Start">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
      <input type="text" name="Folder Path" stage="Folder Path" />
      <input type="text" name="File Name" stage="File Name" />
    </inputs>
    <onsuccess>2b024202-ccc3-4b45-83b9-f68c0b94b3af</onsuccess>
  </stage>
  <stage stageid="70e1a3c2-5431-4555-8c85-8f1954a037c6" name="End" type="End">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" />
  </stage>
  <stage stageid="aca13ce2-dee2-42c1-85be-2629ec728c82" name="saveMyMailAsAttachment" type="Code">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" w="150" h="30" />
    <inputs>
      <input type="text" name="eid" expr="[EntryID]" />
      <input type="text" name="folderPath" expr="[Folder Path]" />
      <input type="text" name="fName" expr="[File Name]" />
    </inputs>
    <onsuccess>70e1a3c2-5431-4555-8c85-8f1954a037c6</onsuccess>
    <code><![CDATA[//DownloadMailFile(string msgid, string downloadFolder)

DownloadMailFile(eid , folderPath,fName);]]></code>
  </stage>
  <stage stageid="2a852370-cb38-452a-9e15-efff05183bab" name="EntryID" type="Data">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="81f55911-c917-47d2-baea-8cb80864f3ed" name="INPUTS" type="Block">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="-45" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="3e55e914-48af-4db7-9174-fc159fd4bb44" name="Folder Path" type="Data">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2b024202-ccc3-4b45-83b9-f68c0b94b3af" name="Connect" type="SubSheet">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="120" h="30" />
    <onsuccess>aca13ce2-dee2-42c1-85be-2629ec728c82</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="1b411314-2b99-402f-a722-8ada5f53a57d" name="File Name" type="Data">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5d52a628-00e2-481a-9399-f206a42e4246" name="Shared Mailbox" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-180" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6a5c680f-41f1-45a9-aac7-9d44db1b3d37" name="GetReceivedItemsFromSubfolderWithSubject" type="Code">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>ComparisonMode.IgnoreCase</narrative>
    <display x="60" y="60" w="180" h="30" />
    <inputs>
      <input type="datetime" name="startDT" expr="[Earliest Received DateTime]" />
      <input type="text" name="mySubfolder" expr="[Subfolder]" />
      <input type="number" name="maxResultCount" expr="[Max Result Count]" />
      <input type="text" name="sharedMailbox" expr="[Shared Mailbox]" />
      <input type="text" name="subjectContainsThis" expr="[Subject Contains]" />
      <input type="text" name="bodyContainsThis" expr="[Body Contains]" />
      <input type="text" name="incRead" expr="[Include Read]" />
      <input type="text" name="senderMailAddress" expr="[Sender Mail Address]" />
      <input type="flag" name="bodyHTML" expr="[HTML Body?]" />
      <input type="text" name="subFolderID" expr="[Subfolder ID]" />
    </inputs>
    <outputs>
      <output type="collection" name="rez" stage="Received Items" />
    </outputs>
    <onsuccess>870f4b98-1142-4f14-a0ee-a421de117778</onsuccess>
    <code><![CDATA[SearchFilter.SearchFilterCollection filterS = new SearchFilter.SearchFilterCollection(LogicalOperator.And);

filterS.Add(new SearchFilter.IsGreaterThanOrEqualTo(ItemSchema.DateTimeReceived,startDT));	

if(subjectContainsThis.Trim().Length>0)
{
	filterS.Add(new SearchFilter.ContainsSubstring(ItemSchema.Subject,subjectContainsThis.Replace("*","")));		
}
if(bodyContainsThis.Trim().Length>0)
{
	filterS.Add(new SearchFilter.ContainsSubstring(ItemSchema.Body,bodyContainsThis.Replace("*","")));		
}
if(incRead.Trim().Length>0)
{
	filterS.Add(new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, incRead.ToLower()=="true"));
}

if(senderMailAddress.Trim().Length>0)
{
	EmailAddress senderMailAddressEA = new EmailAddress(senderMailAddress);
	filterS.Add(new SearchFilter.IsEqualTo(EmailMessageSchema.Sender, senderMailAddressEA));
}

rez = GetMailsInSpecificFolder(mySubfolder,Convert.ToInt32(maxResultCount),sharedMailbox,filterS,bodyHTML,subFolderID);]]></code>
  </stage>
  <stage stageid="257c13f5-9841-499e-9fdd-a70ee419f071" name="Get Categories XML From Server" type="SubSheetInfo">
    <subsheetid>ba008894-e2af-450a-81d8-b23f6d0652b2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-60" w="180" h="60" />
  </stage>
  <stage stageid="17784a82-4293-4f38-9e22-ba34ac87ccdb" name="Start" type="Start">
    <subsheetid>ba008894-e2af-450a-81d8-b23f6d0652b2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" />
    <onsuccess>55057ac6-82ed-4490-8c94-fe37f6802afd</onsuccess>
  </stage>
  <stage stageid="a68659ed-c2c9-4a62-bbe3-e0876a9202c2" name="End" type="End">
    <subsheetid>ba008894-e2af-450a-81d8-b23f6d0652b2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" />
    <outputs>
      <output type="text" name="XML - User Categories Config" stage="XML - User Categories Config" />
    </outputs>
  </stage>
  <stage stageid="57bdfa0d-e0c9-47f8-8365-c0e47b4a77e8" name="getUserConfFromServer" type="Code">
    <subsheetid>ba008894-e2af-450a-81d8-b23f6d0652b2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-30" w="120" h="30" />
    <outputs>
      <output type="text" name="rez" stage="XML - User Categories Config" />
    </outputs>
    <onsuccess>a68659ed-c2c9-4a62-bbe3-e0876a9202c2</onsuccess>
    <code><![CDATA[rez = getCategoriesUserConfig();]]></code>
  </stage>
  <stage stageid="fbc41a64-3c94-4a6f-b2ca-3594b8312938" name="XML - User Categories Config" type="Data">
    <subsheetid>ba008894-e2af-450a-81d8-b23f6d0652b2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="55057ac6-82ed-4490-8c94-fe37f6802afd" name="Connect" type="SubSheet">
    <subsheetid>ba008894-e2af-450a-81d8-b23f6d0652b2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="120" h="30" />
    <onsuccess>57bdfa0d-e0c9-47f8-8365-c0e47b4a77e8</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="fe2ae4ce-1826-4008-ab3e-640aaf6b4a0b" name="OUTPUTS" type="Block">
    <subsheetid>ba008894-e2af-450a-81d8-b23f6d0652b2</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-15" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="811b2b31-818a-44f4-838a-1cc1f0359a1a" name="Move Email To Subfolder" type="SubSheetInfo">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-150" w="180" h="30" />
  </stage>
  <stage stageid="582f3081-78f2-482f-8c90-090361f338cf" name="Start" type="Start">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-135" />
    <inputs>
      <input type="text" name="EntryID" stage="Entry ID" />
      <input type="text" name="Subfolder" stage="Subfolder" />
      <input type="text" name="Shared Mailbox" stage="Shared Mailbox" />
    </inputs>
    <onsuccess>9fa0fec2-9a69-49d6-8a54-eed95c376e30</onsuccess>
  </stage>
  <stage stageid="6c11a735-20d0-4636-845b-0648119ecfdf" name="End" type="End">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" />
    <outputs>
      <output type="text" name="New Entry ID" stage="New Entry ID" />
    </outputs>
  </stage>
  <stage stageid="9a26cc91-12b5-43c8-b8a9-8b0a2020a951" name="moveMailToSubfolder" type="Code">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="150" h="30" />
    <inputs>
      <input type="text" name="eid" expr="[Entry ID]" />
      <input type="text" name="sFolder" expr="[Subfolder]" />
      <input type="text" name="sMailBox" expr="[Shared Mailbox]" />
    </inputs>
    <outputs>
      <output type="text" name="NewEid" stage="New Entry ID" />
    </outputs>
    <onsuccess>6c11a735-20d0-4636-845b-0648119ecfdf</onsuccess>
    <code><![CDATA[NewEid=moveEmailToFolder(eid, sFolder,sMailBox);]]></code>
  </stage>
  <stage stageid="6b8940f0-bb15-4483-8e98-d792412856bc" name="Add Category" type="SubSheetInfo">
    <subsheetid>dd70aaf7-1d6e-4db3-bd4f-b10531330c36</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-135" w="180" h="30" />
  </stage>
  <stage stageid="4fce1323-6ead-4cbf-98c3-bb3afed4f392" name="Start" type="Start">
    <subsheetid>dd70aaf7-1d6e-4db3-bd4f-b10531330c36</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-135" />
    <inputs>
      <input type="text" name="Category" stage="Category" />
      <input type="text" name="EntryID" stage="Entry ID" />
    </inputs>
    <onsuccess>bd672577-38c6-4010-a719-64b81987a03c</onsuccess>
  </stage>
  <stage stageid="ee7ba2cc-3fcf-41fe-af7a-0f72890e1058" name="End" type="End">
    <subsheetid>dd70aaf7-1d6e-4db3-bd4f-b10531330c36</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" />
  </stage>
  <stage stageid="0464168e-9b06-4f29-91dd-5d3ee0c56acf" name="Mark Item As Read" type="SubSheetInfo">
    <subsheetid>d6fbcaa7-665b-4cff-81b7-7e9ef8019b96</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-90" w="180" h="30" />
  </stage>
  <stage stageid="a8593205-2858-4f02-828d-3eccc0f0bdf7" name="Start" type="Start">
    <subsheetid>d6fbcaa7-665b-4cff-81b7-7e9ef8019b96</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="EntryID" stage="Entry ID" />
    </inputs>
    <onsuccess>65bb8360-82ab-4d5f-baec-de9b65addb50</onsuccess>
  </stage>
  <stage stageid="f5d96bf3-040e-4d07-92f9-1c230733f5eb" name="End" type="End">
    <subsheetid>d6fbcaa7-665b-4cff-81b7-7e9ef8019b96</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" />
  </stage>
  <stage stageid="1f31e663-a646-4a55-af23-4cd72879a8e6" name="Mark Item As Unread" type="SubSheetInfo">
    <subsheetid>0cd915a2-53ec-4056-919a-4bc69fe8f0e7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-90" w="180" h="30" />
  </stage>
  <stage stageid="3843f033-4bcb-4bc4-b770-42c70c071d29" name="Start" type="Start">
    <subsheetid>0cd915a2-53ec-4056-919a-4bc69fe8f0e7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="EntryID" stage="Entry ID" />
    </inputs>
    <onsuccess>c57c2a68-8863-44ef-93c9-48c1473f94ff</onsuccess>
  </stage>
  <stage stageid="7a4a5735-3a3c-451b-8d9c-bbb458432fd9" name="End" type="End">
    <subsheetid>0cd915a2-53ec-4056-919a-4bc69fe8f0e7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" />
  </stage>
  <stage stageid="37620bb6-7dab-41e7-a8fc-0e8fd40d871d" name="addCategoryToMyMail" type="Code">
    <subsheetid>dd70aaf7-1d6e-4db3-bd4f-b10531330c36</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="180" h="30" />
    <inputs>
      <input type="text" name="mid" expr="[Entry ID]" />
      <input type="text" name="cat" expr="[Category]" />
    </inputs>
    <onsuccess>ee7ba2cc-3fcf-41fe-af7a-0f72890e1058</onsuccess>
    <code><![CDATA[addCategoryToMail( mid,  cat);]]></code>
  </stage>
  <stage stageid="b2e783e8-4eae-4522-84bb-f3ebfb2931bb" name="INPUTS" type="Block">
    <subsheetid>dd70aaf7-1d6e-4db3-bd4f-b10531330c36</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-105" w="180" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="9982721f-095f-47ed-9822-e2396d5561b8" name="Entry ID" type="Data">
    <subsheetid>dd70aaf7-1d6e-4db3-bd4f-b10531330c36</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4ee3e4df-7db5-4b36-b1c3-a3c80f7bd0f0" name="Category" type="Data">
    <subsheetid>dd70aaf7-1d6e-4db3-bd4f-b10531330c36</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="87fa89fc-de8c-4776-a217-418195d9319a" name="INPUTS" type="Block">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-120" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="e2b77bd8-c759-4cb8-b9b2-93ce004fe5a5" name="Entry ID" type="Data">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="73be3544-e576-4f6a-a8cb-6944cb2ee083" name="Subfolder" type="Data">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="42f654b8-cc75-48ef-ae6a-5c1fef98a706" name="Shared Mailbox" type="Data">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2e77ca17-3622-44e0-a98d-0e6a28d73ec6" name="New Entry ID" type="Data">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f262b73f-6f51-43fe-9b07-a12e6b132f60" name="OUTPUTS" type="Block">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="15" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="ae4572b2-ddad-49ea-ba69-0640e00e693d" name="Create Subfolder" type="SubSheetInfo">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="0" w="180" h="30" />
  </stage>
  <stage stageid="0d1fcbe6-31c5-4038-88ad-310cad12ed2a" name="Start" type="Start">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-330" />
    <inputs>
      <input type="text" name="Shared Mailbox" stage="Shared Mailbox" />
      <input type="text" name="Parent Subfolder" stage="Parent Subfolder" />
      <input type="text" name="Parent Subfolder ID" stage="Parent Subfolder ID" />
      <input type="text" name="New Subfolder" stage="New Subfolder" />
    </inputs>
    <onsuccess>a25123fb-0ff4-4a84-ae6f-17666850f429</onsuccess>
  </stage>
  <stage stageid="70868cff-8769-427c-8dd3-6747467064a4" name="End" type="End">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="-60" />
  </stage>
  <stage stageid="f4f1d6da-1647-458e-bd5d-761458b2136d" name="Reply Email" type="SubSheetInfo">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-135" w="180" h="30" />
  </stage>
  <stage stageid="86f40752-230e-4d18-ab30-880d6f254bf0" name="Start" type="Start">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="-105" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
      <input type="flag" name="Reply To All?" stage="Reply To All?" />
      <input type="text" name="Message" stage="Message" />
      <input type="text" name="Attachments" stage="Attachments" />
    </inputs>
    <onsuccess>7ede5683-28ce-4131-901d-14dec51ebd25</onsuccess>
  </stage>
  <stage stageid="67f51247-2ddf-4f00-9d67-28a6446d5a74" name="End" type="End">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="30" />
  </stage>
  <stage stageid="5797d2fc-fc4a-46be-adc4-bcf82e28efaa" name="replyToEmail" type="Code">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="msgid" expr="[EntryID]" />
      <input type="flag" name="replyToAll" expr="[Reply To All?]" />
      <input type="text" name="messageText" expr="[Message]" />
      <input type="text" name="attachments" expr="[Attachments]" />
    </inputs>
    <outputs>
      <output type="text" name="rezEid" stage="EntryID-Replied Mail" />
    </outputs>
    <onsuccess>67f51247-2ddf-4f00-9d67-28a6446d5a74</onsuccess>
    <code><![CDATA[
string[] attachmentsArr = new string[0];
if(attachments.Trim().Length>3)
{
	attachmentsArr = attachments.Split(';');
}
rezEid=replyEmail(msgid, replyToAll, messageText,attachmentsArr);]]></code>
  </stage>
  <stage stageid="93b2e143-47b2-496a-9f8f-911941737079" name="EntryID" type="Data">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9422e9c2-8020-4921-b54a-f0d610ebf93b" name="INPUTS" type="Block">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="-105" w="180" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="3e4e5617-3406-479b-bf10-2d691e034138" name="Reply To All?" type="Data">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-45" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5b743660-cb99-4f32-8923-8f6da61cc542" name="Message" type="Data">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="72ea4310-20f6-4416-93a8-03b696193efd" name="Attachments" type="Data">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e72d3f8b-9b8f-40c1-b9a9-b5ebe5ff315a" name="Get Subfolders List" type="SubSheetInfo">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-120" w="180" h="30" />
  </stage>
  <stage stageid="cdc4318b-584c-4c15-8165-96f315073930" name="Start" type="Start">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" />
    <inputs>
      <input type="text" name="Shared Mailbox" stage="Shared Mailbox" />
      <input type="text" name="Sub Folder Name (optional)" stage="Filter Results" />
    </inputs>
    <onsuccess>247df1ab-fa73-4525-98e6-a703612edc9a</onsuccess>
  </stage>
  <stage stageid="ec727bf8-fb36-4237-9344-3c729cf20cf6" name="End" type="End">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="120" />
    <outputs>
      <output type="collection" name="Subfolders" stage="Subfolders" />
      <output type="number" name="Subfolders Row Count" stage="Subfolders Row Count" />
    </outputs>
  </stage>
  <stage stageid="24356f05-6bea-4c3b-b0b4-bad8aa9bb9e7" name="INPUTS" type="Block">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="-90" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="d722bc81-d6ae-43f9-96dc-a0c3b8d0dc35" name="Shared Mailbox" type="Data">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="92d0fbfe-8c8b-4a5d-a2c3-758328f20f55" name="OUTPUTS" type="Block">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="15" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="f10803f1-8c77-4fc4-b6c9-a55f9dfaf385" name="Subfolders" type="Collection">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="45" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="247df1ab-fa73-4525-98e6-a703612edc9a" name="Connect" type="SubSheet">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <onsuccess>e1ad7445-36e8-41ee-be89-a629e3daa90d</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="857d9efd-fce9-40dd-9fa6-54bc9fc9b26d" name="Configure - Simple" type="SubSheetInfo">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-90" w="180" h="30" />
  </stage>
  <stage stageid="8b3c459e-6365-49e4-9db4-deb285be22bc" name="Start" type="Start">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-180" />
    <inputs>
      <input type="text" name="Mail User" stage="Mail User" />
      <input type="flag" name="Use Failover Account in Exception?" stage="Failover flag" />
    </inputs>
    <onsuccess>8c741025-a34d-44c7-893a-881f8cfc5e5f</onsuccess>
  </stage>
  <stage stageid="e515855c-666b-4e92-a2e4-b62ccefdba93" name="End" type="End">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="390" />
  </stage>
  <stage stageid="aaf9a38b-207c-40f5-ba50-0b16d4d0ab89" name="Robot Users" type="Collection">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="90" w="180" h="60" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
    <collectioninfo>
      <field name="Machine" type="text" />
      <field name="Username" type="text" />
      <field name="UID" type="text" />
      <field name="Mailbox" type="text" />
      <field name="EWS Username" type="text" />
      <field name="Credentials Name" type="text" />
    </collectioninfo>
    <initialvalue>
      <row>
        <field name="Machine" type="text" value="ROBOTPC001" />
        <field name="Username" type="text" value="Bot James" />
        <field name="UID" type="text" value="user1234" />
        <field name="Mailbox" type="text" value="james@company.com" />
        <field name="EWS Username" type="text" value="DOMAIN\user1234" />
        <field name="Credentials Name" type="text" value="Windows Login: James" />
      </row>
      <row>
        <field name="Machine" type="text" value="ROBOTPC002" />
        <field name="Username" type="text" value="Bot Kirk" />
        <field name="UID" type="text" value="user1235" />
        <field name="Mailbox" type="text" value="kirk@company.com" />
        <field name="EWS Username" type="text" value="DOMAIN\user1235" />
        <field name="Credentials Name" type="text" value="Windows Login: Kirk" />
      </row>
      <row>
        <field name="Machine" type="text" value="ROBOTPC003" />
        <field name="Username" type="text" value="Bot Lars" />
        <field name="UID" type="text" value="user1236" />
        <field name="Mailbox" type="text" value="lars@company.com" />
        <field name="EWS Username" type="text" value="DOMAIN\user1236" />
        <field name="Credentials Name" type="text" value="Windows Login: Lars" />
      </row>
      <row>
        <field name="Machine" type="text" value="ROBOTPC004" />
        <field name="Username" type="text" value="Bot Cliff" />
        <field name="UID" type="text" value="user1237" />
        <field name="Mailbox" type="text" value="cliff@company.com" />
        <field name="EWS Username" type="text" value="DOMAIN\user1237" />
        <field name="Credentials Name" type="text" value="Windows Login: Cliff" />
      </row>
    </initialvalue>
  </stage>
  <stage stageid="bf6b5810-5dea-4a15-8f27-29cf8f2a0d95" name="Mail User" type="Data">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d6a5d96a-72fb-4dea-8575-f72eb87022ea" name="Create Filter For User" type="ChoiceStart">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-30" w="90" h="30" />
    <groupid>d81cbcef-7057-4c44-b066-0a6972106d0f</groupid>
    <choices>
      <choice expression="StartsWith(Upper([Mail User]),&quot;ROBOTPC&quot;)">
        <name>Machine Name?</name>
        <distance>30</distance>
        <ontrue>2db1eb08-49a2-48cc-84c0-d16532a797b0</ontrue>
      </choice>
      <choice expression="StartsWith(Lower([Mail User]),&quot;bot &quot;)">
        <name>Bot Name?</name>
        <distance>75</distance>
        <ontrue>68b5e169-13ad-41e7-ae03-5429ac50e93e</ontrue>
      </choice>
      <choice expression="InStr([Mail User],&quot;@&quot;)&gt;0 AND InStr([Mail User],&quot;.&quot;)&gt;0">
        <name>Mail Address?</name>
        <distance>135</distance>
        <ontrue>eedceccc-55c2-4b0f-aec8-9f1084e50f54</ontrue>
      </choice>
      <choice expression="StartsWith(Lower([Mail User]),&quot;user&quot;)">
        <name>UID?</name>
        <distance>180</distance>
        <ontrue>0cc0dd48-7acb-475d-ae66-48dfc086e01f</ontrue>
      </choice>
    </choices>
  </stage>
  <stage stageid="f178c25c-8cec-4519-8652-b8e9925432f7" name="OW" type="ChoiceEnd">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="195" />
    <onsuccess>848d8080-8c91-43cb-8b24-cd1a11bbe5ef</onsuccess>
    <groupid>d81cbcef-7057-4c44-b066-0a6972106d0f</groupid>
  </stage>
  <stage stageid="166d3bfb-4074-4f5d-b166-ca23a9c221f0" name="Filtered Robot Collection" type="Collection">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="150" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f49dfdde-d1b9-4bb8-bd25-14913ad23aaf" name="RowCount-Filtered Robot Users" type="Data">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="195" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bea9a5ae-795f-4bee-a514-fd32d71c8448" name="Only One Row Found?" type="Decision">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="285" y="195" w="90" h="30" />
    <decision expression="[RowCount-Filtered Robot Users]=1" />
    <ontrue>ac1e3b01-76a3-4b79-8180-cf856726d1d1</ontrue>
    <onfalse>848d8080-8c91-43cb-8b24-cd1a11bbe5ef</onfalse>
  </stage>
  <stage stageid="ac1e3b01-76a3-4b79-8180-cf856726d1d1" name="Credentials::Get" type="Action">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="285" y="255" w="120" h="30" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="[Filtered Robot Collection.Credentials Name]" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="_Password" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="_EWS Mail Username" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>c9f8e21a-f31b-4676-a29f-daabdfd81602</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="7839443c-9e2c-4250-b934-25b3e0f50b29" name="INPUTS" type="Block">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-375" y="-60" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="462bc3c3-04ed-4400-bc41-4a68a71371af" name="LOKAL" type="Block">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-375" y="45" w="180" h="180" />
  </stage>
  <stage stageid="e9e53e0c-b186-40e9-a42a-23aa256cb428" name="Get Text Body Of Email" type="SubSheetInfo">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-75" w="180" h="30" />
  </stage>
  <stage stageid="88d7ef07-1fa0-4af2-9089-483ff0db9850" name="Start" type="Start">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
    </inputs>
    <onsuccess>0d88455c-7f92-48ab-be2d-76bfbdf22af4</onsuccess>
  </stage>
  <stage stageid="a23bd18a-4d48-49f8-af62-2437c52736fb" name="End" type="End">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="90" />
    <outputs>
      <output type="text" name="Plain Text Body" stage="Plain Text Body" />
    </outputs>
  </stage>
  <stage stageid="6eec749a-cfd4-41c5-b1f1-a943db6f92b7" name="EntryID" type="Data">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="b810279e-290d-4b5b-a422-5cf70bd14daa" name="INPUTS" type="Block">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="-45" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="74cb1751-126c-4d31-a544-c487abbd1e03" name="getPlainTextMailBody" type="Code">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>ComparisonMode.IgnoreCase</narrative>
    <display x="15" y="45" w="180" h="30" />
    <inputs>
      <input type="text" name="eid" expr="[EntryID]" />
    </inputs>
    <outputs>
      <output type="text" name="rez" stage="Plain Text Body" />
    </outputs>
    <onsuccess>a23bd18a-4d48-49f8-af62-2437c52736fb</onsuccess>
    <code><![CDATA[rez=getTextBodyOfEmail(eid);]]></code>
  </stage>
  <stage stageid="b6a5b570-85cc-442b-9924-d3fb92f56415" name="Plain Text Body" type="Data">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e1a8c52e-3dac-4b16-8c29-d8398ac3ffd8" name="OUTPUTS" type="Block">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="30" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="671d51fb-2570-4b09-8c1a-9ae340215ee4" name="Delete Email" type="SubSheetInfo">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-90" w="180" h="30" />
  </stage>
  <stage stageid="a6e71e16-7d7f-4c4b-876a-56a1cabf24a2" name="Start" type="Start">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" />
    <inputs>
      <input type="text" name="EntryID" stage="Entry ID" />
      <input type="flag" name="Soft Delete? (Default)" stage="Soft Delete?" />
      <input type="flag" name="Move To Deleted Items?" stage="Move To Deleted Items?" />
      <input type="flag" name="Hard Delete?" stage="Hard Delete?" />
    </inputs>
    <onsuccess>c9c47e3e-31e9-4526-9dd8-00dd494057f0</onsuccess>
  </stage>
  <stage stageid="d1140778-2eb1-4d0d-a59f-c3fddc547beb" name="End" type="End">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" />
  </stage>
  <stage stageid="5341f928-52e1-497f-afcf-aab8c85701c2" name="Flag Item Completed" type="SubSheetInfo">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-105" w="180" h="30" />
  </stage>
  <stage stageid="bbd2ae6b-e56d-48d3-945e-3ccb90150674" name="Start" type="Start">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-150" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
      <input type="datetime" name="Completed DateTime" stage="Completed DateTime" />
    </inputs>
    <onsuccess>34ebdca9-eff6-48bd-bbb9-8f12c3e31d16</onsuccess>
  </stage>
  <stage stageid="803cf1af-8eaa-4c9d-a708-dcc378d053ee" name="End" type="End">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" />
  </stage>
  <stage stageid="5a97f374-92b8-46c3-a392-bc7e86c89b61" name="Get Sent Items" type="SubSheetInfo">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-180" w="180" h="30" />
  </stage>
  <stage stageid="d886c8ce-4f66-4d38-bbab-c8f8fb53ba1a" name="Start" type="Start">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" />
    <inputs>
      <input type="datetime" name="Earliest Sent DateTime" stage="Earliest Sent DateTime" />
      <input type="number" name="Max Result Count" stage="Max Result Count" />
      <input type="text" name="Sender Mail Address" stage="Sender Mail Address" />
      <input type="text" name="Body Contains" stage="Body Contains" />
      <input type="text" name="Subject Contains" stage="Subject Contains" />
      <input type="flag" name="HTML Body?" stage="HTML Body?" />
      <input type="text" name="TO Display Name Contains" stage="TO Display Name" />
    </inputs>
    <onsuccess>bba70d9d-4a8a-42cc-ad08-83d387ba3928</onsuccess>
  </stage>
  <stage stageid="456946f9-8716-430c-a3e2-fc3229de6d14" name="End" type="End">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="60" />
    <outputs>
      <output type="collection" name="Sent Items" stage="Sent Items" />
      <output type="number" name="RowCount-Sent Items" stage="RowCount-Sent Items" />
    </outputs>
  </stage>
  <stage stageid="98ac1783-9aad-4e2e-889a-87ffac02e5ad" name="Forward Mail" type="SubSheetInfo">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-180" w="180" h="30" />
  </stage>
  <stage stageid="79f79e0c-d67f-4abb-82f8-a6683f46ffb0" name="Start" type="Start">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-90" />
    <inputs>
      <input type="text" name="To" stage="To" />
      <input type="text" name="CC" stage="CC" />
      <input type="text" name="BCC" stage="BCC" />
      <input type="text" name="Subject" stage="Subject" />
      <input type="text" name="Message" stage="Message" />
      <input type="text" name="Attachments" stage="Attachments" />
      <input type="text" name="EntryID" stage="EntryID" />
    </inputs>
    <onsuccess>83043dcf-5c41-4f18-83a0-8e410461b5bd</onsuccess>
  </stage>
  <stage stageid="c8155f55-a029-4f53-ae03-3b7937ce0b30" name="End" type="End">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="45" />
  </stage>
  <stage stageid="73064651-ccfd-4d1b-82fd-63b884090799" name="forwardMyMail" type="Code">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="0" w="120" h="30" />
    <inputs>
      <input type="text" name="mSubject" expr="[Subject]" />
      <input type="text" name="mBody" expr="[Message]" />
      <input type="text" name="mTO" expr="[To]" />
      <input type="text" name="mCC" expr="[CC]" />
      <input type="text" name="mBCC" expr="[BCC]" />
      <input type="text" name="mAttachments" expr="[Attachments]" />
      <input type="text" name="eid" expr="[EntryID]" />
    </inputs>
    <outputs>
      <output type="text" name="fwMailEntryID" stage="EntryID-Forwarded Mail" />
    </outputs>
    <onsuccess>c8155f55-a029-4f53-ae03-3b7937ce0b30</onsuccess>
    <code><![CDATA[string[] attachmentsArr = new string[]{};
if(mAttachments.Trim().Length>0)
{
	attachmentsArr=mAttachments.Split(';');	
}

fwMailEntryID=forwardMessage(eid,mSubject,mBody,mTO,mCC,mBCC,attachmentsArr);

//forwardMessage(string msgid, string subject,string body,string toRecipients, string ccRecipients, string bccRecipients, string[] attachmentsArr)]]></code>
  </stage>
  <stage stageid="1869e73d-4fcb-4150-aa69-c17da4c6f012" name="To" type="Data">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9e977e0b-a3fa-470b-8cfc-895a875e58f9" name="INPUTS" type="Block">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="-150" w="180" h="255" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="cba851e9-7e24-4269-89c7-a7c16c9aa268" name="CC" type="Data">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="98a253e1-6688-43b8-92c2-6a3708891345" name="BCC" type="Data">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="53d06f51-57bb-4f71-a492-47f1742cfba4" name="Subject" type="Data">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="751e6203-c314-4b0b-832a-cf99d516cfd0" name="Message" type="Data">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="326fdcdc-cb1d-4bac-8da9-d620d20c6906" name="Attachments" type="Data">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="83043dcf-5c41-4f18-83a0-8e410461b5bd" name="Connect" type="SubSheet">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-45" w="120" h="30" />
    <onsuccess>73064651-ccfd-4d1b-82fd-63b884090799</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="209ef1f5-e5fb-4c60-9ca2-bc4598074964" name="EntryID" type="Data">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-120" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0d88455c-7f92-48ab-be2d-76bfbdf22af4" name="Connect" type="SubSheet">
    <subsheetid>4dff665c-7cf8-47c3-b0d8-899132c7fc0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" w="120" h="30" />
    <onsuccess>74cb1751-126c-4d31-a544-c487abbd1e03</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="9fa0fec2-9a69-49d6-8a54-eed95c376e30" name="Connect" type="SubSheet">
    <subsheetid>d0981b19-5d6e-43d2-8300-acf527d2c618</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" w="120" h="30" />
    <onsuccess>9a26cc91-12b5-43c8-b8a9-8b0a2020a951</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="7ede5683-28ce-4131-901d-14dec51ebd25" name="Connect" type="SubSheet">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="-60" w="120" h="30" />
    <onsuccess>5797d2fc-fc4a-46be-adc4-bcf82e28efaa</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="bd672577-38c6-4010-a719-64b81987a03c" name="Connect" type="SubSheet">
    <subsheetid>dd70aaf7-1d6e-4db3-bd4f-b10531330c36</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" w="120" h="30" />
    <onsuccess>37620bb6-7dab-41e7-a8fc-0e8fd40d871d</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="049c1c75-1479-4cd0-9e91-e2a9660b7ef4" name="Remove Category" type="SubSheetInfo">
    <subsheetid>86b3c655-bb01-4083-b7f0-85a60402b8cb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-135" w="180" h="30" />
  </stage>
  <stage stageid="39c932e9-43a9-44dc-a546-e23792807f77" name="Start" type="Start">
    <subsheetid>86b3c655-bb01-4083-b7f0-85a60402b8cb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-150" />
    <inputs>
      <input type="text" name="Category" stage="Category" />
      <input type="text" name="EntryID" stage="Entry ID" />
    </inputs>
    <onsuccess>aee1a5b6-ef55-4b2f-b830-c3210fb0b5a5</onsuccess>
  </stage>
  <stage stageid="4a4a5fbb-6b60-4c00-9d58-76e5b3c02f2c" name="End" type="End">
    <subsheetid>86b3c655-bb01-4083-b7f0-85a60402b8cb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" />
  </stage>
  <stage stageid="55eb0d2e-c088-47e1-bcec-9cf602a901b4" name="removeCategoryFromMyMail" type="Code">
    <subsheetid>86b3c655-bb01-4083-b7f0-85a60402b8cb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="180" h="30" />
    <inputs>
      <input type="text" name="mid" expr="[Entry ID]" />
      <input type="text" name="cat" expr="[Category]" />
    </inputs>
    <onsuccess>4a4a5fbb-6b60-4c00-9d58-76e5b3c02f2c</onsuccess>
    <code><![CDATA[removeCategoryFromMail(mid,cat);]]></code>
  </stage>
  <stage stageid="91618267-644f-430b-93ab-838aef8dce53" name="INPUTS" type="Block">
    <subsheetid>86b3c655-bb01-4083-b7f0-85a60402b8cb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-105" w="180" h="105" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="a03eddb8-c693-43bb-b1e5-8a21e2b48fd4" name="Entry ID" type="Data">
    <subsheetid>86b3c655-bb01-4083-b7f0-85a60402b8cb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e710fc7b-bad3-4d83-bb1b-7e619d84b6bd" name="Category" type="Data">
    <subsheetid>86b3c655-bb01-4083-b7f0-85a60402b8cb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="aee1a5b6-ef55-4b2f-b830-c3210fb0b5a5" name="Connect" type="SubSheet">
    <subsheetid>86b3c655-bb01-4083-b7f0-85a60402b8cb</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" w="120" h="30" />
    <onsuccess>55eb0d2e-c088-47e1-bcec-9cf602a901b4</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="a6f3cc4f-c38b-47f8-825e-970406d4bc3c" name="markMyMailAsRead" type="Code">
    <subsheetid>d6fbcaa7-665b-4cff-81b7-7e9ef8019b96</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="180" h="30" />
    <inputs>
      <input type="text" name="mid" expr="[Entry ID]" />
    </inputs>
    <onsuccess>f5d96bf3-040e-4d07-92f9-1c230733f5eb</onsuccess>
    <code><![CDATA[markMailItemAsRead(mid);]]></code>
  </stage>
  <stage stageid="9d1cf747-9d68-48a8-9edc-6f082580fbbc" name="INPUTS" type="Block">
    <subsheetid>d6fbcaa7-665b-4cff-81b7-7e9ef8019b96</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-60" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="da953580-7835-412e-a60a-fe864a6ca17e" name="Entry ID" type="Data">
    <subsheetid>d6fbcaa7-665b-4cff-81b7-7e9ef8019b96</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="65bb8360-82ab-4d5f-baec-de9b65addb50" name="Connect" type="SubSheet">
    <subsheetid>d6fbcaa7-665b-4cff-81b7-7e9ef8019b96</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <onsuccess>a6f3cc4f-c38b-47f8-825e-970406d4bc3c</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="8e65e0ec-7b89-4943-b2f7-ec04da364d4f" name="markMyMailAsUnread" type="Code">
    <subsheetid>0cd915a2-53ec-4056-919a-4bc69fe8f0e7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-15" w="180" h="30" />
    <inputs>
      <input type="text" name="mid" expr="[Entry ID]" />
    </inputs>
    <onsuccess>7a4a5735-3a3c-451b-8d9c-bbb458432fd9</onsuccess>
    <code><![CDATA[markMailItemAsUnread(mid);]]></code>
  </stage>
  <stage stageid="6d3bcaff-6298-49be-8d9f-5fa680e9d97e" name="INPUTS" type="Block">
    <subsheetid>0cd915a2-53ec-4056-919a-4bc69fe8f0e7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-60" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="85a6b54f-23ba-46ad-901a-b34b87fbe727" name="Entry ID" type="Data">
    <subsheetid>0cd915a2-53ec-4056-919a-4bc69fe8f0e7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c57c2a68-8863-44ef-93c9-48c1473f94ff" name="Connect" type="SubSheet">
    <subsheetid>0cd915a2-53ec-4056-919a-4bc69fe8f0e7</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <onsuccess>8e65e0ec-7b89-4943-b2f7-ec04da364d4f</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="a5d813ca-3ed8-4ad8-ab65-42584652769b" name="Add DOMAIN Prefix" type="MultipleCalculation">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="345" w="90" h="30" />
    <onsuccess>e515855c-666b-4e92-a2e4-b62ccefdba93</onsuccess>
    <steps>
      <calculation expression="&quot;DOMAIN\&quot;&amp;[_EWS Mail Username]" stage="_EWS Mail Username" />
    </steps>
  </stage>
  <stage stageid="978dfedb-60e0-476b-8dd3-7c696852a0b9" name="deleteMyEmail" type="Code">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" w="180" h="30" />
    <inputs>
      <input type="text" name="mid" expr="[Entry ID]" />
      <input type="flag" name="dmHard" expr="[Hard Delete?]" />
      <input type="flag" name="dmMove" expr="[Move To Deleted Items?]" />
      <input type="flag" name="dmSoft" expr="[Soft Delete?]" />
    </inputs>
    <onsuccess>d1140778-2eb1-4d0d-a59f-c3fddc547beb</onsuccess>
    <code><![CDATA[DeleteMode delMode ;
if(dmHard)
{
	delMode = DeleteMode.HardDelete;
}
else if(dmSoft)
{
	delMode = DeleteMode.SoftDelete;
}
else if(dmMove)
{
	delMode = DeleteMode.MoveToDeletedItems;
}
else
{
	throw new Exception("One of the Delete Mode Flags must be true");
}

deleteEmail(mid,delMode);]]></code>
  </stage>
  <stage stageid="21f9f08d-9542-452c-889e-66fe71fa8b76" name="INPUTS" type="Block">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-60" w="180" h="165" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="654d179d-83e5-43e1-b83c-df66da5288a1" name="Entry ID" type="Data">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c9c47e3e-31e9-4526-9dd8-00dd494057f0" name="Connect" type="SubSheet">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="120" h="30" />
    <onsuccess>978dfedb-60e0-476b-8dd3-7c696852a0b9</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="462ef803-881e-4743-aa54-08851d569b84" name="HTML Body?" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-345" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8c741025-a34d-44c7-893a-881f8cfc5e5f" name="URL EWS Empty?" type="Decision">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-135" w="90" h="30" />
    <decision expression="Len([_URL-EWS Server])=0" />
    <ontrue>3367166c-3398-4e31-a73c-c519b29d974c</ontrue>
    <onfalse>c05e766d-347e-4f10-a97e-142d9ea7e261</onfalse>
  </stage>
  <stage stageid="3367166c-3398-4e31-a73c-c519b29d974c" name="Assign Environment Value URL" type="Calculation">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="-135" w="120" h="30" />
    <onsuccess>c05e766d-347e-4f10-a97e-142d9ea7e261</onsuccess>
    <calculation expression="[URL-Exchange WEBService]" stage="_URL-EWS Server" />
  </stage>
  <stage stageid="c05e766d-347e-4f10-a97e-142d9ea7e261" name="Username Empty?" type="Decision">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-45" y="-90" w="90" h="30" />
    <decision expression="Len([Mail User])=0" />
    <ontrue>a1c37ea4-7f63-4189-8c92-eb0ffc42e479</ontrue>
    <onfalse>d6a5d96a-72fb-4dea-8575-f72eb87022ea</onfalse>
  </stage>
  <stage stageid="be8d423d-abbf-4247-9748-9f6896065cce" name="Configure - Simple" type="SubSheet">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="-15" w="90" h="60" />
    <inputs>
      <input type="text" name="Mail User" friendlyname="Mail User" expr="" />
      <input type="flag" name="Use Failover Account in Exception?" friendlyname="Use Failover Account in Exception?" expr="" />
    </inputs>
    <onsuccess>58718f31-9bc1-400e-92de-d63939fab554</onsuccess>
    <processid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</processid>
  </stage>
  <stage stageid="58718f31-9bc1-400e-92de-d63939fab554" name="Anchor1" type="Anchor">
    <subsheetid>b017fe03-e78c-4969-9318-6861e6bef92c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="180" y="90" w="10" h="10" />
    <onsuccess>8cfd6d36-2032-406d-8a61-abd073451f10</onsuccess>
  </stage>
  <stage stageid="dc7766b3-775b-483c-8bbf-626d23e3c717" name="PARAMS" type="Block">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-375" y="240" w="180" h="60" />
  </stage>
  <stage stageid="b9d5a3f2-9e75-482b-9399-eff4e644ed4e" name="getMySentItems" type="Code">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-30" w="150" h="30" />
    <inputs>
      <input type="datetime" name="startDT" expr="[Earliest Sent DateTime]" />
      <input type="number" name="Maximum_Row" expr="[Max Result Count]" />
      <input type="flag" name="bodyHTML" expr="[HTML Body?]" />
      <input type="text" name="bodyContainsThis" expr="[Body Contains]" />
      <input type="text" name="subjectContainsThis" expr="[Subject Contains]" />
      <input type="text" name="senderMailAddress" expr="[Sender Mail Address]" />
      <input type="text" name="TODispName" expr="[TO Display Name]" />
    </inputs>
    <outputs>
      <output type="collection" name="rez" stage="Sent Items" />
    </outputs>
    <onsuccess>cd29da0f-971e-4401-a4cb-d2fdb015b534</onsuccess>
    <code><![CDATA[SearchFilter.SearchFilterCollection filterS = new SearchFilter.SearchFilterCollection(LogicalOperator.And);
filterS.Add(new SearchFilter.IsGreaterThanOrEqualTo(ItemSchema.DateTimeReceived,startDT));	
if(subjectContainsThis.Trim().Length>0)
{
	filterS.Add(new SearchFilter.ContainsSubstring(ItemSchema.Subject,subjectContainsThis.Replace("*","")));		
}
if(bodyContainsThis.Trim().Length>0)
{
	filterS.Add(new SearchFilter.ContainsSubstring(ItemSchema.Body,bodyContainsThis.Replace("*","")));		
}
if(senderMailAddress.Trim().Length>0)
{
	EmailAddress senderMailAddressEA = new EmailAddress(senderMailAddress);
	filterS.Add(new SearchFilter.IsEqualTo(EmailMessageSchema.Sender, senderMailAddressEA));
}
if(TODispName.Trim().Length>0)
{
	string[] toReps = TODispName.Replace(",",";").Replace("|",";").Split(';');
	foreach(string toRep in toReps)
	{
		filterS.Add(new SearchFilter.ContainsSubstring(ItemSchema.DisplayTo,toRep));
	}	
}
rez=GetSentItems(Convert.ToInt32(Maximum_Row),filterS,bodyHTML);]]></code>
  </stage>
  <stage stageid="bba70d9d-4a8a-42cc-ad08-83d387ba3928" name="Connect" type="SubSheet">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="120" h="30" />
    <onsuccess>b9d5a3f2-9e75-482b-9399-eff4e644ed4e</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="cf812732-3701-4c8e-8c25-7b80f654c9d1" name="Earliest Sent DateTime" type="Data">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-120" w="180" h="30" />
    <datatype>datetime</datatype>
    <initialvalue>2000-01-01 00:00:00Z</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f10ad0a9-45f5-4095-b3b4-2de72b73694f" name="Sent Items" type="Collection">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="150" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a3b19b42-64c2-4c14-bff4-58693974308f" name="OUTPUTS" type="Block">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="120" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="2cfa34bf-828a-448a-9cc0-6a38bd18c6e0" name="RowCount-Sent Items" type="Data">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="180" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ea0a4b2a-1d87-45cc-b5e1-46b619c4140a" name="INPUTS" type="Block">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="-150" w="180" h="255" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="4d5a34d6-ea70-4cb4-87c0-635de7d0c876" name="Max Result Count" type="Data">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-90" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue>99</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="dec05a82-2540-44eb-b599-9f7a3a23349a" name="EntryID-Forwarded Mail" type="Data">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="150" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="c9493511-03d0-47a1-ae5a-a4d2658bd54b" name="OUTPUTS" type="Block">
    <subsheetid>b1e88d5b-90cf-451e-a278-0dd480d19112</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="120" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="eebe946e-b4a8-4abb-a408-3d50d3b5e55d" name="EntryID-Replied Mail" type="Data">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d4286d88-55ee-4544-9395-d72b3ece0e6b" name="OUTPUTS" type="Block">
    <subsheetid>b2968ee4-506f-41ee-9637-b9d270c27d9c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="60" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="3c1a9915-d835-49ab-986f-6336d6ee9728" name="Subject Contains" type="Data">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="54a2cf41-9fd3-4fed-bb09-154eaa1e08c5" name="Body Contains" type="Data">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="45881062-e7b3-4881-ade5-8ab28ebf0dd0" name="HTML Body?" type="Data">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="45" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3588014e-9138-4a1a-87bb-32dbca49cf68" name="Sender Mail Address" type="Data">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="cf76474f-e932-4cef-bf17-010adda7e151" name="TO Display Name" type="Data">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ff9e0213-6709-47cc-bba9-077661dceff2" name="Get Received Items - Advanced" type="SubSheetInfo">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-270" w="180" h="30" />
  </stage>
  <stage stageid="51d2c7eb-d883-4fe6-87e2-20e1d5663af2" name="Start" type="Start">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-240" />
    <inputs>
      <input type="text" name="Subfolder" stage="Subfolder" />
      <input type="text" name="Subfolder ID" stage="Subfolder ID" />
      <input type="number" name="Max Result Count" stage="Max Result Count" />
      <input type="text" name="Shared Mailbox" stage="Shared Mailbox" />
      <input type="flag" name="HTML Body ?" stage="HTML Body?" />
      <input type="text" name="Query String" stage="Query String" />
    </inputs>
    <onsuccess>83386cd3-b69d-4b87-ba14-a1880fa51fd2</onsuccess>
  </stage>
  <stage stageid="279d4d7d-9cfd-4e8c-967d-9d09e73c46cf" name="End" type="End">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-15" />
    <outputs>
      <output type="collection" name="Received Items" stage="Received Items" />
      <output type="number" name="RowCount-Received Items" stage="RowCount-Received Items" />
    </outputs>
  </stage>
  <stage stageid="22809743-0b72-43eb-9df4-61c2cab6d2e8" name="Received Items" type="Collection">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="15" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="83386cd3-b69d-4b87-ba14-a1880fa51fd2" name="Connect" type="SubSheet">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-195" w="120" h="30" />
    <onsuccess>e8a3f808-4d00-474e-bfa7-b3cc70638dff</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="e4f360b7-82ad-4345-a236-91cc762f8954" name="OUTPUTS" type="Block">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-15" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="c4e177a1-6751-4026-b054-11d682de47d9" name="RowCount-Received Items" type="Data">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="45" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="8c7f31e0-2cc1-4661-aaa7-2af1ec501752" name="INPUTS" type="Block">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-240" w="180" h="210" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="a3b77a5b-3e91-47b0-bc85-0f725069bdc9" name="Subfolder" type="Data">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2268aeec-664b-438e-b244-c7e3710d1e30" name="Max Result Count" type="Data">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-60" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue>99</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="323d3f28-e09f-4d19-b43c-2f1a91f3c262" name="Shared Mailbox" type="Data">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-150" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="41c736a5-0fdf-450c-8fdd-2e40c11b9255" name="HTML Body?" type="Data">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-210" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="535e5b9c-e1c4-474a-95d3-245fd4046aa4" name="GetReceivedItemsFromSubfolderWithSubjectADVANCED" type="Code">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>ComparisonMode.IgnoreCase</narrative>
    <display x="60" y="-105" w="240" h="30" />
    <inputs>
      <input type="text" name="mySubfolder" expr="[Subfolder]" />
      <input type="number" name="maxResultCount" expr="[Max Result Count]" />
      <input type="text" name="sharedMailbox" expr="[Shared Mailbox]" />
      <input type="flag" name="bodyHTML" expr="[HTML Body?]" />
      <input type="text" name="searchStringQ" expr="[Query String]" />
    </inputs>
    <outputs>
      <output type="collection" name="rez" stage="Received Items" />
    </outputs>
    <onsuccess>17fefe88-0b04-43e9-8135-f3a019cb1503</onsuccess>
    <code><![CDATA[
rez = GetMailsInSpecificFolderAdvanced(mySubfolder,Convert.ToInt32(maxResultCount),sharedMailbox,searchStringQ,bodyHTML);
]]></code>
  </stage>
  <stage stageid="34ac6c92-ba25-4a83-90f0-eb8735203b8e" name="Subject Contains" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-210" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="053803f9-5a6c-4dba-a1ee-a8210a758297" name="Body Contains" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-240" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="45f71585-8844-4276-9716-9954619f905f" name="Include Read" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>true
False 
Or Blank</narrative>
    <display x="-195" y="-300" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4c46922d-5c9d-402f-813c-6f6576ae1b0d" name="Sender Mail Address" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-270" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ae689077-b6e9-4320-bb26-c82a2fce02b7" name="Query String" type="Data">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-180" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a80db43e-eb4d-4969-8b28-b28021f10a3d" name="Note4" type="Note">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>I know Microsoft Documentation is an eye sore but:
https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/querystring-querystringtype?redirectedfrom=MSDN</narrative>
    <display x="630" y="-30" w="270" h="90" />
    <onsuccess>279d4d7d-9cfd-4e8c-967d-9d09e73c46cf</onsuccess>
  </stage>
  <stage stageid="0eef31a6-685e-459f-b731-cb93d007456d" name="Note5" type="Note">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>https://stackoverflow.com/questions/40224713/ews-querystring-received-date-off-by-one-day</narrative>
    <display x="630" y="-105" w="270" h="30" />
    <onsuccess>a80db43e-eb4d-4969-8b28-b28021f10a3d</onsuccess>
  </stage>
  <stage stageid="63362fe9-3493-4078-a2c0-37257825ee81" name="Get Sent Items - Advanced" type="SubSheetInfo">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-180" w="180" h="30" />
  </stage>
  <stage stageid="7c4339f6-7201-449f-9f74-a3a58db2c80f" name="Start" type="Start">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-120" />
    <inputs>
      <input type="number" name="Max Result Count" stage="Max Result Count" />
      <input type="flag" name="HTML Body?" stage="HTML Body?" />
      <input type="text" name="Query String" stage="Query String" />
    </inputs>
    <onsuccess>1d5b456e-3ba8-496c-8019-2b7e05372a21</onsuccess>
  </stage>
  <stage stageid="0fdd6d58-16f8-4af5-a030-1131252f1334" name="End" type="End">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="60" />
    <outputs>
      <output type="collection" name="Sent Items" stage="Sent Items" />
      <output type="number" name="RowCount-Sent Items" stage="RowCount-Sent Items" />
    </outputs>
  </stage>
  <stage stageid="fb3fc34e-c2f9-4dff-9c73-acffffaf0e65" name="getMySentItemsAdvanced" type="Code">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-30" w="150" h="30" />
    <inputs>
      <input type="number" name="Maximum_Row" expr="[Max Result Count]" />
      <input type="flag" name="bodyHTML" expr="[HTML Body?]" />
      <input type="text" name="queryS" expr="[Query String]" />
    </inputs>
    <outputs>
      <output type="collection" name="rez" stage="Sent Items" />
    </outputs>
    <onsuccess>06ab5cd3-a166-464f-b6fa-4b6d6b819348</onsuccess>
    <code><![CDATA[rez=GetSentItemsAdvanced(Convert.ToInt32(Maximum_Row),queryS,bodyHTML);]]></code>
  </stage>
  <stage stageid="1d5b456e-3ba8-496c-8019-2b7e05372a21" name="Connect" type="SubSheet">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-75" w="120" h="30" />
    <onsuccess>fb3fc34e-c2f9-4dff-9c73-acffffaf0e65</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="3c1e3146-0791-47c1-8deb-85bd204dd650" name="Sent Items" type="Collection">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="15" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="04b66488-8206-4a04-90c6-b7f3d9ffb87e" name="OUTPUTS" type="Block">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="-15" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="98f2ff3a-3da5-4735-b54c-7272e9b98ee9" name="RowCount-Sent Items" type="Data">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="45" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="07f684b4-e7ab-4c7c-8919-2d1cbbff394e" name="INPUTS" type="Block">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="-150" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="4ddc0da5-443f-4b15-b0ab-9909f6799d00" name="Max Result Count" type="Data">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-120" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue>99</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="753e9562-e39a-4316-9fc2-62858566c4de" name="HTML Body?" type="Data">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-60" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d46c43f6-fbf7-4c7d-a770-56f8e197efcd" name="Query String" type="Data">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="-90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e01cdb6d-17c9-43e6-be07-a60a3e58eaca" name="Send Email Using Template" type="SubSheetInfo">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-180" w="180" h="30" />
  </stage>
  <stage stageid="8bd5a806-63f3-4314-b82e-c37b34dec536" name="Start" type="Start">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-60" />
    <inputs>
      <input type="text" name="FilePATH-EML_Template" stage="FilePATH-EML_Template" />
      <input type="text" name="To" stage="To" />
      <input type="text" name="CC" stage="CC" />
      <input type="text" name="BCC" stage="BCC" />
      <input type="collection" name="Replace Body Values One Row Collection" narrative="One row collection robot replaces the field name with the value at first row. See examples" stage="Body Replace One Row" />
      <input type="collection" name="Replace Subject Values One Row Collection" narrative="One row collection robot replaces the field name with the value at first row. See examples" stage="Subject Replace One Row" />
      <input type="text" name="Attachments" stage="Attachments" />
      <input type="text" name="Shared Mailbox (Send As)" stage="Shared Mailbox" />
      <input type="text" name="EML Encoding" stage="EML Encoding" />
    </inputs>
    <onsuccess>520d3175-cf3f-4ba9-923a-c11ff06f06db</onsuccess>
  </stage>
  <stage stageid="3c124d49-9a9b-438e-8be0-4014f0f7276c" name="End" type="End">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="165" />
  </stage>
  <stage stageid="867e70c2-a243-45da-b29a-30ca4730475d" name="getDankMimeContent" type="Code">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="120" w="120" h="30" />
    <inputs>
      <input type="text" name="fPath" expr="[FilePATH-EML_Template]" />
      <input type="text" name="toRecipients" expr="[To]" />
      <input type="collection" name="replaceSubject" expr="[Subject Replace One Row]" />
      <input type="collection" name="replaceBody" expr="[Body Replace One Row]" />
      <input type="text" name="ccRecipients" expr="[CC]" />
      <input type="text" name="bccRecipients" expr="[BCC]" />
      <input type="text" name="attachments" expr="[Attachments]" />
      <input type="text" name="sharedMailbox" expr="[Shared Mailbox]" />
      <input type="text" name="emlEncoding" expr="[EML Encoding]" />
    </inputs>
    <onsuccess>3c124d49-9a9b-438e-8be0-4014f0f7276c</onsuccess>
    <code><![CDATA[sendMailUsingEMLTemplate(fPath,toRecipients,ref replaceSubject,ref replaceBody,ccRecipients,bccRecipients,attachments,sharedMailbox,emlEncoding);

//MimeContent mc = em.MimeContent;]]></code>
  </stage>
  <stage stageid="c90228a3-49d4-401b-b036-81af87161acd" name="FilePATH-EML_Template" type="Data">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-120" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2df6dbf5-991b-4499-a6d5-28575dcf6aaf" name="Connect" type="SubSheet">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="75" w="120" h="30" />
    <onsuccess>867e70c2-a243-45da-b29a-30ca4730475d</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="4ba4e302-eba3-4540-b4d0-b478911d719a" name="To" type="Data">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9dab9ae5-1e0a-49b7-bc3d-a606cb26a419" name="CC" type="Data">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-45" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2de562c7-0e29-4c71-99eb-b42f9f003d55" name="BCC" type="Data">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="bee80242-8fd7-45bb-b237-483ccdf6b586" name="Attachments" type="Data">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="105" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f5bc6f30-aa2e-4003-83de-63941909452b" name="INPUTS" type="Block">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-150" w="180" h="360" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="d6e09e04-eec5-4afc-a394-6b5147bc2836" name="INPUTS" type="Block">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-75" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="02f02b5b-2c7b-409e-8881-e357ad652108" name="EntryID" type="Data">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="34ebdca9-eff6-48bd-bbb9-8f12c3e31d16" name="Connect" type="SubSheet">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" w="120" h="30" />
    <onsuccess>e1ab5e68-6c04-4757-a770-2d4262c7cb98</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="99a7d1c9-c484-4714-8d1e-624f1de01936" name="flagMyItemCompleted" type="Code">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" w="120" h="30" />
    <inputs>
      <input type="datetime" name="compDT" expr="[Completed DateTime]" />
      <input type="text" name="eid" expr="[EntryID]" />
    </inputs>
    <onsuccess>803cf1af-8eaa-4c9d-a708-dcc378d053ee</onsuccess>
    <code><![CDATA[ updateMailItemFlag(eid,2,compDT,DateTime.Now);]]></code>
  </stage>
  <stage stageid="64323cd3-a257-480b-b5a8-2c03cbbc059a" name="Completed DateTime" type="Data">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-45" w="180" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5e8a1653-23fe-4e90-8860-a952a3a784d9" name="Useless" type="Data">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6ae59fd3-0a8b-4c93-8436-6b26dd520712" name="Now()" type="Calculation">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="105" y="-45" />
    <onsuccess>99a7d1c9-c484-4714-8d1e-624f1de01936</onsuccess>
    <calculation expression="Now()" stage="Completed DateTime" />
  </stage>
  <stage stageid="e1ab5e68-6c04-4757-a770-2d4262c7cb98" name="DateTime Present?" type="Decision">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="90" h="30" />
    <decision expression="IsDateTime([Completed DateTime])" />
    <ontrue>99a7d1c9-c484-4714-8d1e-624f1de01936</ontrue>
    <onfalse>6ae59fd3-0a8b-4c93-8436-6b26dd520712</onfalse>
  </stage>
  <stage stageid="8750c923-897a-4500-991f-f8a1d75fe2c3" name="Flag Item Remove Flags" type="SubSheetInfo">
    <subsheetid>0d796ae5-30b5-4b4a-aada-b1e14544875a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-75" w="180" h="30" />
  </stage>
  <stage stageid="1acac17d-8615-4a21-bccd-2e090edaa8b3" name="Start" type="Start">
    <subsheetid>0d796ae5-30b5-4b4a-aada-b1e14544875a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
    </inputs>
    <onsuccess>eb98eaa5-8120-4ae2-b25f-c83a798a3ef1</onsuccess>
  </stage>
  <stage stageid="04d35aa8-5fd6-4887-8e2a-692cfb57d131" name="End" type="End">
    <subsheetid>0d796ae5-30b5-4b4a-aada-b1e14544875a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" />
  </stage>
  <stage stageid="c3452513-3f23-4773-b08e-336fe4e40292" name="INPUTS" type="Block">
    <subsheetid>0d796ae5-30b5-4b4a-aada-b1e14544875a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-45" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="3ab292d4-4348-4156-9b4a-bd7339f38fe4" name="EntryID" type="Data">
    <subsheetid>0d796ae5-30b5-4b4a-aada-b1e14544875a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="eb98eaa5-8120-4ae2-b25f-c83a798a3ef1" name="Connect" type="SubSheet">
    <subsheetid>0d796ae5-30b5-4b4a-aada-b1e14544875a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="120" h="30" />
    <onsuccess>76ec41f1-34c7-4bd1-a8eb-9d54605dcc43</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="76ec41f1-34c7-4bd1-a8eb-9d54605dcc43" name="UNflagMyItem" type="Code">
    <subsheetid>0d796ae5-30b5-4b4a-aada-b1e14544875a</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" w="120" h="30" />
    <inputs>
      <input type="text" name="eid" expr="[EntryID]" />
    </inputs>
    <onsuccess>04d35aa8-5fd6-4887-8e2a-692cfb57d131</onsuccess>
    <code><![CDATA[ updateMailItemFlag(eid,0,DateTime.Now,DateTime.Now);]]></code>
  </stage>
  <stage stageid="9d6c2385-33e2-492f-aa94-1f864e6b8d7e" name="Flag Item" type="SubSheetInfo">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-105" w="180" h="30" />
  </stage>
  <stage stageid="fb4d350e-528e-4175-a602-456a3a891c45" name="Start" type="Start">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-135" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
      <input type="datetime" name="Due DateTime" stage="Due DateTime" />
    </inputs>
    <onsuccess>9b38a197-7ca3-4380-a4ac-1bfa0f816307</onsuccess>
  </stage>
  <stage stageid="0360943c-b907-4acd-9017-2de0ec70b0d5" name="End" type="End">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="45" />
  </stage>
  <stage stageid="bdd862c0-c84e-4132-9efc-f9aa0cf8c606" name="INPUTS" type="Block">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-75" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="ef374d3a-091a-46a8-a270-97ee003e5f74" name="EntryID" type="Data">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9b38a197-7ca3-4380-a4ac-1bfa0f816307" name="Connect" type="SubSheet">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" w="120" h="30" />
    <onsuccess>a0cb18fa-2866-427a-88cb-1bfa30d7fd42</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="c97b069f-13af-46d6-8c34-a3f758db9c15" name="flagMyItem" type="Code">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" w="120" h="30" />
    <inputs>
      <input type="datetime" name="dueDateDT" expr="[Due DateTime]" />
      <input type="text" name="eid" expr="[EntryID]" />
    </inputs>
    <onsuccess>0360943c-b907-4acd-9017-2de0ec70b0d5</onsuccess>
    <code><![CDATA[ updateMailItemFlag(eid,1,DateTime.Now,dueDateDT);]]></code>
  </stage>
  <stage stageid="2029de20-a717-4369-9e6a-03d032cf4a6a" name="Due DateTime" type="Data">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-45" w="180" h="30" />
    <datatype>datetime</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="a0cb18fa-2866-427a-88cb-1bfa30d7fd42" name="DateTime Present?" type="Decision">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="90" h="30" />
    <decision expression="IsDateTime([Due DateTime])" />
    <ontrue>c97b069f-13af-46d6-8c34-a3f758db9c15</ontrue>
    <onfalse>70eb38b6-09d4-4cc0-ba7c-f893469fb2f9</onfalse>
  </stage>
  <stage stageid="70eb38b6-09d4-4cc0-ba7c-f893469fb2f9" name="SE" type="Exception">
    <subsheetid>1b8b2338-9a83-40d2-90ba-61567d2c0fb0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="120" y="-45" />
    <exception localized="yes" type="System Exception" detail="&quot;Due Date Datetime value is empty&quot; " />
  </stage>
  <stage stageid="78145ef6-5cd9-4bd6-919b-3c01ee4b59ef" name="My Life" type="Block">
    <subsheetid>39c37c2e-c3f0-4632-83de-b7ede20c3e5d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="30" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="333333" />
  </stage>
  <stage stageid="9dfea676-c868-497f-919c-180b6b038689" name="Get Credentials-FAILOVER PROFILE" type="Action">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>Get the specified set of credentials.

An Exception will occur if access to the credentials is not allowed, based on the running Resource, Process and User.</narrative>
    <display x="30" y="300" w="90" h="30" />
    <inputs>
      <input type="text" name="Credentials Name" friendlyname="Credentials Name" narrative="The name of the credentials to get" expr="&quot;Windows Login: FAILOVER PROFILE&quot;" />
    </inputs>
    <outputs>
      <output type="password" name="Password" friendlyname="Password" narrative="The password" stage="_Password" />
      <output type="text" name="Username" friendlyname="Username" narrative="The user name" stage="_EWS Mail Username" />
      <output type="date" name="Expiry Date" friendlyname="Expiry Date" narrative="The expiry date" stage="" />
      <output type="text" name="Status" friendlyname="Status" narrative="The status" stage="" />
    </outputs>
    <onsuccess>a5d813ca-3ed8-4ad8-ab65-42584652769b</onsuccess>
    <resource object="Blueprism.Automate.clsCredentialsActions" action="Get" />
  </stage>
  <stage stageid="039ff502-ab57-4b8e-bdcd-dfed50d2f151" name="Block1" type="Block">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="165" y="225" w="195" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="7FB2E5" />
  </stage>
  <stage stageid="848d8080-8c91-43cb-8b24-cd1a11bbe5ef" name="Anchor2" type="Anchor">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="30" y="195" w="10" h="10" />
    <onsuccess>66770c2e-1d86-4392-8c50-db117b004e50</onsuccess>
  </stage>
  <stage stageid="c9f8e21a-f31b-4676-a29f-daabdfd81602" name="Anchor3" type="Anchor">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="285" y="345" w="10" h="10" />
    <onsuccess>a5d813ca-3ed8-4ad8-ab65-42584652769b</onsuccess>
  </stage>
  <stage stageid="f2a01fb5-5e64-4c91-901f-c5cfbd11ef4e" name="Reco" type="Recover">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="195" y="255" w="30" h="30" />
    <onsuccess>326da7f2-e5b6-4998-b0db-3ef90131be83</onsuccess>
  </stage>
  <stage stageid="326da7f2-e5b6-4998-b0db-3ef90131be83" name="Reso" type="Resume">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="135" y="255" w="30" h="30" />
    <onsuccess>66770c2e-1d86-4392-8c50-db117b004e50</onsuccess>
  </stage>
  <stage stageid="faee2a2e-2f50-40e0-b7d1-f78e9a1fb3bc" name="Filter DataTable" type="SubSheetInfo">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-105" w="180" h="30" />
  </stage>
  <stage stageid="a84cc100-b5bc-4cc7-81af-2531d79380c0" name="Start" type="Start">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="-60" />
    <inputs>
      <input type="collection" name="Collection" stage="Collection" />
      <input type="text" name="Filter String" stage="Filter String" />
    </inputs>
    <onsuccess>a6b6f14b-0aaf-4cac-82aa-e712e4779228</onsuccess>
  </stage>
  <stage stageid="67871799-c840-4703-90f5-937726de8b23" name="End" type="End">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="30" />
    <outputs>
      <output type="collection" name="Collection Filtered" stage="Collection Filtered" />
    </outputs>
  </stage>
  <stage stageid="a6b6f14b-0aaf-4cac-82aa-e712e4779228" name="filterMyDT" type="Code">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="-15" w="120" h="30" />
    <inputs>
      <input type="collection" name="dt" expr="[Collection]" />
      <input type="text" name="myFilter" expr="[Filter String]" />
    </inputs>
    <outputs>
      <output type="collection" name="rez" stage="Collection Filtered" />
    </outputs>
    <onsuccess>67871799-c840-4703-90f5-937726de8b23</onsuccess>
    <code><![CDATA[DataView dv = new DataView(dt);
dv.RowFilter = myFilter; 	
rez= dv.ToTable();]]></code>
  </stage>
  <stage stageid="fd837529-4c6f-4b61-9b16-cb13c34f6f66" name="Collection" type="Collection">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-45" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1072f0cf-a708-4f2a-9ede-60e5daaaa42a" name="Filter String" type="Data">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="38a0b2ca-98d1-4ece-a053-32df803289a5" name="INPUTS" type="Block">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-75" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="c9ffe101-100b-4a91-9f2b-3c18be133265" name="Collection Filtered" type="Collection">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="60" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="efc22756-3d6d-4963-8d78-df6a4b4116ac" name="OUTPUTS" type="Block">
    <subsheetid>800c91fb-147c-4abb-b77e-ada5c6df6202</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="30" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="2db1eb08-49a2-48cc-84c0-d16532a797b0" name="Filter DataTable" type="SubSheet">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="0" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Robot Users]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Machine]='&quot;&amp;[Mail User]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Filtered Robot Collection" />
    </outputs>
    <onsuccess>47afa321-e89a-45bd-8f3f-dfaabf0e817e</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="68b5e169-13ad-41e7-ae03-5429ac50e93e" name="Filter DataTable" type="SubSheet">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="45" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Robot Users]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Username]='&quot;&amp;[Mail User]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Filtered Robot Collection" />
    </outputs>
    <onsuccess>47afa321-e89a-45bd-8f3f-dfaabf0e817e</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="eedceccc-55c2-4b0f-aec8-9f1084e50f54" name="Filter DataTable" type="SubSheet">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="105" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Robot Users]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Mailbox]='&quot;&amp;[Mail User]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Filtered Robot Collection" />
    </outputs>
    <onsuccess>47afa321-e89a-45bd-8f3f-dfaabf0e817e</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="0cc0dd48-7acb-475d-ae66-48dfc086e01f" name="Filter DataTable" type="SubSheet">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="150" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Robot Users]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[UID]='&quot;&amp;[Mail User]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Filtered Robot Collection" />
    </outputs>
    <onsuccess>47afa321-e89a-45bd-8f3f-dfaabf0e817e</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="cd6bed76-51b5-4b79-961a-f09b26692e0d" name="Remove Duplciates From DataTable" type="SubSheetInfo">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-105" w="180" h="30" />
  </stage>
  <stage stageid="8556b47d-235f-486e-aeb5-425fa6af2535" name="Start" type="Start">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="-60" />
    <inputs>
      <input type="collection" name="Collection" stage="Collection" />
      <input type="text" name="Header" stage="Header" />
    </inputs>
    <onsuccess>8525b75e-1488-44ff-aaa7-eca834888490</onsuccess>
  </stage>
  <stage stageid="b83e91d9-614c-4ac3-9b16-28d1935abb84" name="End" type="End">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="30" />
    <outputs>
      <output type="collection" name="Collection Filtered" stage="Collection Filtered" />
      <output type="number" name="Row Count Filtered" stage="Row Count Filtered" />
    </outputs>
  </stage>
  <stage stageid="8525b75e-1488-44ff-aaa7-eca834888490" name="removeDuplicateByColumn" type="Code">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="45" y="-15" w="120" h="30" />
    <inputs>
      <input type="collection" name="coll" expr="[Collection]" />
      <input type="text" name="header" expr="[Header]" />
    </inputs>
    <outputs>
      <output type="collection" name="rez" stage="Collection Filtered" />
      <output type="number" name="rezRowCount" stage="Row Count Filtered" />
    </outputs>
    <onsuccess>b83e91d9-614c-4ac3-9b16-28d1935abb84</onsuccess>
    <code><![CDATA[DataTable dt = coll.Clone();
List<string> distListOfValues = new List<string>();

for (int i = 0; i < coll.Rows.Count; i++)
{
	string valueToSearch = coll.Rows[i][header].ToString();
	if(distListOfValues.Contains(valueToSearch)== false)
	{
		dt.ImportRow(coll.Rows[i]);
		distListOfValues.Add(valueToSearch);
	}
}

rez = dt;
rezRowCount=dt.Rows.Count;]]></code>
  </stage>
  <stage stageid="7a605623-4604-4ab7-9fea-53e3e54fd51f" name="Collection" type="Collection">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-45" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5bf131fb-8d1d-48bd-9430-101766beb71d" name="Header" type="Data">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="7a778aab-0f91-46bb-9a21-8057dec4ef65" name="INPUTS" type="Block">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-75" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="3a9b6a40-ae21-409a-8089-092044804046" name="Collection Filtered" type="Collection">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="60" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="5d98ab81-0c91-465e-9daf-61f97772f9e2" name="OUTPUTS" type="Block">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="30" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="47afa321-e89a-45bd-8f3f-dfaabf0e817e" name="Remove Duplciates From DataTable" type="SubSheet">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="285" y="75" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Filtered Robot Collection]" />
      <input type="text" name="Header" friendlyname="Header" expr="&quot;Credentials Name&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Filtered Robot Collection" />
      <output type="number" name="Row Count Filtered" friendlyname="Row Count Filtered" stage="RowCount-Filtered Robot Users" />
    </outputs>
    <onsuccess>bea9a5ae-795f-4bee-a514-fd32d71c8448</onsuccess>
    <processid>bb215801-0055-472d-b487-e7db3041f6c8</processid>
  </stage>
  <stage stageid="460f8246-0993-414f-8bb7-e75670a3fb66" name="Row Count Filtered" type="Data">
    <subsheetid>bb215801-0055-472d-b487-e7db3041f6c8</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="90" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4783f1f8-28e8-47ec-88fa-0f92f3a74c21" name="Count Rows Of DataTable" type="SubSheetInfo">
    <subsheetid>b8f093c0-bb02-4888-a792-608bbec62b95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-60" w="180" h="30" />
  </stage>
  <stage stageid="68feb6ae-fdb7-4dd0-b666-ecab761adeb8" name="Start" type="Start">
    <subsheetid>b8f093c0-bb02-4888-a792-608bbec62b95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="-30" />
    <inputs>
      <input type="collection" name="Collection" stage="Collection" />
    </inputs>
    <onsuccess>df16faff-5c0d-4293-975c-05815e8e4ccc</onsuccess>
  </stage>
  <stage stageid="70982522-d095-4e46-a64b-5a331a43e66e" name="End" type="End">
    <subsheetid>b8f093c0-bb02-4888-a792-608bbec62b95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="60" />
    <outputs>
      <output type="number" name="Row Count" stage="Row Count" />
    </outputs>
  </stage>
  <stage stageid="1f0bcd74-7781-4f7f-9ff7-62f9c03c054a" name="Collection" type="Collection">
    <subsheetid>b8f093c0-bb02-4888-a792-608bbec62b95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="0" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d42ddd1b-6916-4168-8050-d4eb0b27e215" name="INPUTS" type="Block">
    <subsheetid>b8f093c0-bb02-4888-a792-608bbec62b95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="-30" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="e5622c57-3430-4d55-b75c-0c031530a67a" name="OUTPUTS" type="Block">
    <subsheetid>b8f093c0-bb02-4888-a792-608bbec62b95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="45" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="4ee4b604-0bdc-4358-8a0c-4526e85b037a" name="Row Count" type="Data">
    <subsheetid>b8f093c0-bb02-4888-a792-608bbec62b95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="75" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="df16faff-5c0d-4293-975c-05815e8e4ccc" name="countMyRows" type="Code">
    <subsheetid>b8f093c0-bb02-4888-a792-608bbec62b95</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-15" y="15" w="120" h="30" />
    <inputs>
      <input type="collection" name="dt" expr="[Collection]" />
    </inputs>
    <outputs>
      <output type="number" name="rez" stage="Row Count" />
    </outputs>
    <onsuccess>70982522-d095-4e46-a64b-5a331a43e66e</onsuccess>
    <code><![CDATA[rez = dt.Rows.Count;]]></code>
  </stage>
  <stage stageid="870f4b98-1142-4f14-a0ee-a421de117778" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="105" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Received Items]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="RowCount-Received Items" />
    </outputs>
    <onsuccess>a7d65de1-7f7d-4c2a-98cf-72fef074d1e3</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="17fefe88-0b04-43e9-8135-f3a019cb1503" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="60" y="-60" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Received Items]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="RowCount-Received Items" />
    </outputs>
    <onsuccess>279d4d7d-9cfd-4e8c-967d-9d09e73c46cf</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="cd29da0f-971e-4401-a4cb-d2fdb015b534" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>f46e4c89-a500-498e-b99a-2a9db676539f</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="15" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Sent Items]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="RowCount-Sent Items" />
    </outputs>
    <onsuccess>456946f9-8716-430c-a3e2-fc3229de6d14</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="06ab5cd3-a166-464f-b6fa-4b6d6b819348" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>7652bb6b-74af-46c3-b5f8-327420058668</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="15" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Sent Items]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="RowCount-Sent Items" />
    </outputs>
    <onsuccess>0fdd6d58-16f8-4af5-a030-1131252f1334</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="9f9b63f3-ff72-4dfb-a5af-f14cb29941fd" name="Get User Name" type="SubSheetInfo">
    <subsheetid>01ab113b-e8d7-4c07-8f9b-e7c9ee047ff3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-135" w="180" h="30" />
  </stage>
  <stage stageid="ecc00860-774b-401d-a345-263af819b4ee" name="Start" type="Start">
    <subsheetid>01ab113b-e8d7-4c07-8f9b-e7c9ee047ff3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-135" />
    <onsuccess>7a4d6675-c58e-493e-9702-d3064b061c89</onsuccess>
  </stage>
  <stage stageid="15748489-4c41-4f9f-b97e-eed3a9fec892" name="End" type="End">
    <subsheetid>01ab113b-e8d7-4c07-8f9b-e7c9ee047ff3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-45" />
    <outputs>
      <output type="text" name="User Name" narrative="The name of the logged in user in the current system" stage="Username" />
    </outputs>
  </stage>
  <stage stageid="7a4d6675-c58e-493e-9702-d3064b061c89" name="GetMyUserName" type="Code">
    <subsheetid>01ab113b-e8d7-4c07-8f9b-e7c9ee047ff3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-60" y="-90" w="90" h="30" />
    <outputs>
      <output type="text" name="username" stage="Username" />
    </outputs>
    <onsuccess>15748489-4c41-4f9f-b97e-eed3a9fec892</onsuccess>
    <code><![CDATA[
username = Environment.UserName;]]></code>
  </stage>
  <stage stageid="5629bc5a-76fd-473b-9a8e-e1323ee7320f" name="Username" type="Data">
    <subsheetid>01ab113b-e8d7-4c07-8f9b-e7c9ee047ff3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-75" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="67aa92e0-bad2-4f60-b416-a4203361a434" name="OUTPUTS" type="Block">
    <subsheetid>01ab113b-e8d7-4c07-8f9b-e7c9ee047ff3</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="-105" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="a1c37ea4-7f63-4189-8c92-eb0ffc42e479" name="Get User Name" type="SubSheet">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="90" y="-90" w="90" h="30" />
    <outputs>
      <output type="text" name="User Name" friendlyname="User Name" narrative="The name of the logged in user in the current system" stage="Mail User" />
    </outputs>
    <onsuccess>d6a5d96a-72fb-4dea-8575-f72eb87022ea</onsuccess>
    <processid>01ab113b-e8d7-4c07-8f9b-e7c9ee047ff3</processid>
  </stage>
  <stage stageid="508152fa-9531-4843-8472-499054b08e2f" name="Shared Mailbox" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="105" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="520d3175-cf3f-4ba9-923a-c11ff06f06db" name="getFileExtension" type="Code">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit />
    <display x="60" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="fpath" expr="[FilePATH-EML_Template]" />
    </inputs>
    <outputs>
      <output type="text" name="rez" stage="File Extension" />
    </outputs>
    <onsuccess>0ab530c7-b655-47ed-9ea5-5673aeace378</onsuccess>
    <code><![CDATA[rez = Path.GetExtension(fpath);]]></code>
  </stage>
  <stage stageid="fa295568-6330-4b29-94e6-8ae78dfa480d" name="File Extension" type="Data">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <display x="-195" y="255" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0ab530c7-b655-47ed-9ea5-5673aeace378" name="Is It An EML File?" type="Decision">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit />
    <display x="60" y="30" w="90" h="30" />
    <decision expression="Lower([File Extension])=&quot;.eml&quot;" />
    <ontrue>2df6dbf5-991b-4499-a6d5-28575dcf6aaf</ontrue>
    <onfalse>628884ac-763b-4e0e-83d0-69e9041921e1</onfalse>
  </stage>
  <stage stageid="628884ac-763b-4e0e-83d0-69e9041921e1" name="SE" type="Exception">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <display x="165" y="30" />
    <exception localized="yes" type="System Exception" detail="&quot;File must be an EML file&quot; " />
  </stage>
  <stage stageid="f9c11ce2-c99a-4878-b2e9-fbe83eb9386e" name="Local" type="Block">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="225" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="333333" />
  </stage>
  <stage stageid="2c7e6bf3-dd20-49dd-88e0-97253a85823a" name="Shared Mailbox" type="Data">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="135" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1b834030-ec3a-4cfe-ac3d-a97fb7aa8ab6" name="EML Encoding" type="Data">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit />
    <display x="-195" y="180" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">UTF-8</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3a16dd2e-2375-4915-8068-9b62e33bfb6b" name="Get Draft Items" type="SubSheetInfo">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <display x="-240" y="-90" w="180" h="30" />
  </stage>
  <stage stageid="b2ecd3ff-d97c-4ac1-88ca-878735232d7a" name="Start" type="Start">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <onsuccess>dc8aa6c1-58f2-4143-b844-d542edf382be</onsuccess>
  </stage>
  <stage stageid="47dfb127-2750-40da-a208-e74743b23c38" name="End" type="End">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <loginhibit />
    <display x="15" y="75" />
    <outputs>
      <output type="collection" name="Draft Items" stage="Draft Items" />
      <output type="number" name="RowCount-Draft Items" stage="RowCount-Draft Items" />
    </outputs>
  </stage>
  <stage stageid="73ec3f86-c9ff-4ddd-90bf-9711e1180ff3" name="Draft Items" type="Collection">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="-30" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="dc8aa6c1-58f2-4143-b844-d542edf382be" name="Connect" type="SubSheet">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <onsuccess>93771c1c-7130-4b17-a060-2d302a61483d</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="08ef6b78-17fa-49b0-aa69-bb333e9bb929" name="OUTPUTS" type="Block">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="-60" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="bfca57bc-e8a7-4080-996e-4d6f34af4220" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="30" w="120" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Draft Items]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="RowCount-Draft Items" />
    </outputs>
    <onsuccess>47dfb127-2750-40da-a208-e74743b23c38</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="93771c1c-7130-4b17-a060-2d302a61483d" name="getMyDraftItems" type="Code">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <loginhibit />
    <display x="15" y="-15" w="120" h="30" />
    <outputs>
      <output type="collection" name="rez" stage="Draft Items" />
    </outputs>
    <onsuccess>bfca57bc-e8a7-4080-996e-4d6f34af4220</onsuccess>
    <code><![CDATA[rez = GetDraftItems(true);]]></code>
  </stage>
  <stage stageid="7c5943c0-55ba-4007-8b97-c435d4157674" name="Update Draft Item HTML" type="SubSheetInfo">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <display x="-210" y="-180" w="180" h="30" />
  </stage>
  <stage stageid="c2bdb05c-cbef-4e29-aa1f-4078e040135c" name="Start" type="Start">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit />
    <display x="15" y="-150" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
      <input type="text" name="Body HTML" stage="Body HTML" />
      <input type="text" name="Subject" stage="Subject" />
    </inputs>
    <onsuccess>3ff6a43d-189f-431e-8f04-4d172aee4bf0</onsuccess>
  </stage>
  <stage stageid="cba25786-1206-4fc9-a567-b8cc18e6aa96" name="End" type="End">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit />
    <display x="15" y="30" />
  </stage>
  <stage stageid="97761789-0767-4ce3-982f-a825a6a571ad" name="RowCount-Draft Items" type="Data">
    <subsheetid>544cb7de-1531-4520-a475-9344654901f4</subsheetid>
    <display x="-240" y="0" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="fcbcd069-324e-448a-be31-0f0009f998b3" name="updateMyDraftMailBody" type="Code">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit />
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="eid" expr="[EntryID]" />
      <input type="text" name="bodyHTML" expr="[Body HTML]" />
    </inputs>
    <onsuccess>cba25786-1206-4fc9-a567-b8cc18e6aa96</onsuccess>
    <code><![CDATA[updateDraftItemHTML(eid,bodyHTML);]]></code>
  </stage>
  <stage stageid="e88c147a-0500-4bcb-a198-53e6f4b88859" name="INPUTS" type="Block">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-300" y="-150" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="f1381678-68af-46e3-a319-95d1df5b94fd" name="Body HTML" type="Data">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9e20bfbb-cf38-494d-87b7-e2029d560394" name="EntryID" type="Data">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-120" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3ff6a43d-189f-431e-8f04-4d172aee4bf0" name="Connect" type="SubSheet">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-105" w="120" h="30" />
    <onsuccess>eeb997e9-85e1-4047-a775-abf17b70b751</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="de7ea86c-d9e1-4322-86cf-6034ff884035" name="Subject Replace One Row" type="Collection">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit />
    <display x="-195" y="30" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0cd95aef-6863-403f-889c-73467fe6a06e" name="Body Replace One Row" type="Collection">
    <subsheetid>e8a210c0-bf39-4b8e-88d0-6cdd68c8b632</subsheetid>
    <loginhibit />
    <display x="-195" y="60" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="12c88619-cd31-4301-ae11-5dea5d40bed3" name="Subject" type="Data">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-210" y="-60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="eeb997e9-85e1-4047-a775-abf17b70b751" name="Update Body HTML?" type="Decision">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit />
    <display x="15" y="-60" w="90" h="30" />
    <decision expression="Len(Trim([Body HTML]))&gt;0" />
    <ontrue>fcbcd069-324e-448a-be31-0f0009f998b3</ontrue>
    <onfalse>87f1b4d2-cf84-4c58-b6e0-0b5afd27bd7b</onfalse>
  </stage>
  <stage stageid="87f1b4d2-cf84-4c58-b6e0-0b5afd27bd7b" name="End" type="End">
    <subsheetid>e46c0ded-deb4-4566-9175-e7773a5adeb4</subsheetid>
    <loginhibit />
    <display x="165" y="-60" />
  </stage>
  <stage stageid="5659b8ad-c3dd-4688-9252-8ad9cbac6b83" name="Add Signture From HTML (EXPERIMENTAL)" type="SubSheetInfo">
    <subsheetid>65554530-3120-4a40-a6f7-e23cba6dd55b</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="bce0fdfa-512b-45ca-b954-be60f18c8e33" name="Start" type="Start">
    <subsheetid>65554530-3120-4a40-a6f7-e23cba6dd55b</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <onsuccess>8386a7f0-5f76-486f-a48b-684544b562c8</onsuccess>
  </stage>
  <stage stageid="d2258cf7-25f3-4109-b1cb-f0fd748b99a3" name="End" type="End">
    <subsheetid>65554530-3120-4a40-a6f7-e23cba6dd55b</subsheetid>
    <loginhibit />
    <display x="15" y="30" />
  </stage>
  <stage stageid="8386a7f0-5f76-486f-a48b-684544b562c8" name="Connect" type="SubSheet">
    <subsheetid>65554530-3120-4a40-a6f7-e23cba6dd55b</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-60" w="120" h="30" />
    <onsuccess>579879d9-0e1e-4680-8096-03f455d81a08</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="579879d9-0e1e-4680-8096-03f455d81a08" name="Code1" type="Code">
    <subsheetid>65554530-3120-4a40-a6f7-e23cba6dd55b</subsheetid>
    <loginhibit />
    <display x="15" y="-15" w="120" h="30" />
    <inputs>
      <input type="text" name="sigName" expr="&quot;My Bot Test Signature&quot;" />
      <input type="text" name="signatureHTML" expr="[Signature HTML]" />
    </inputs>
    <onsuccess>d2258cf7-25f3-4109-b1cb-f0fd748b99a3</onsuccess>
    <code><![CDATA[addUpdateSignatureToOWA(sigName,signatureHTML,true);]]></code>
  </stage>
  <stage stageid="b6a93bdc-a7af-4c09-95d2-2febf229fd55" name="Signature HTML" type="Data">
    <subsheetid>65554530-3120-4a40-a6f7-e23cba6dd55b</subsheetid>
    <loginhibit />
    <display x="-195" y="-15" w="150" h="60" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9be85c8d-c148-4f35-9f5c-f144e0f43257" name="Note6" type="Note">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit />
    <narrative>https://learn.microsoft.com/en-us/exchange/client-developer/exchange-web-services/how-to-perform-an-aqs-search-by-using-ews-in-exchange#creating-a-query-string</narrative>
    <display x="630" y="-150" w="270" h="30" />
    <font family="Segoe UI" size="10" style="Bold" color="3366FF" />
    <onsuccess>0eef31a6-685e-459f-b731-cb93d007456d</onsuccess>
  </stage>
  <stage stageid="e1ad7445-36e8-41ee-be89-a629e3daa90d" name="getMyFoldersList" type="Code">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit />
    <display x="15" y="-15" w="150" h="30" />
    <inputs>
      <input type="text" name="sharedMB" expr="[Shared Mailbox]" />
    </inputs>
    <outputs>
      <output type="collection" name="rez" stage="Subfolders" />
    </outputs>
    <onsuccess>19cbdbad-a4c7-45e9-972c-75a42370bbb3</onsuccess>
    <code><![CDATA[DataTable dt = getFullFoldersListAtRoot(sharedMB);
dt.Columns.Add("Full Folder Path",typeof(string));

for (int i = 0; i < dt.Rows.Count; i++)
{
	string eachParentFolderID	=	dt.Rows[i]["Parent Folder ID"].ToString();
	string fullFolderPath		=	dt.Rows[i]["Display Name"].ToString();

	while(true)
	{
		DataTable filterTemp = applyFilterToDataTable(ref dt,"[Folder ID]='"+eachParentFolderID+"'");
		if(filterTemp.Rows.Count==0)
		{
			dt.Rows[i]["Full Folder Path"] = fullFolderPath; // DONT CONTINUE HERE IT WILL BECOME INFINITE LOOP
			break;
		}	
		else
		{			
			if(eachParentFolderID==filterTemp.Rows[0]["Parent Folder ID"].ToString())
			{
				dt.Rows[i]["Full Folder Path"] = fullFolderPath;	// DONT CONTINUE HERE IT WILL BECOME INFINITE LOOP
				break;				
			}
			else
			{
				fullFolderPath = filterTemp.Rows[0]["Display Name"].ToString()+"|"+fullFolderPath;
				eachParentFolderID = filterTemp.Rows[0]["Parent Folder ID"].ToString();
			}			

		}
	}
}

dt.Columns.Remove("Parent Folder ID");
rez = dt;]]></code>
  </stage>
  <stage stageid="5f963303-e1ed-422f-b6f0-21e9744c2ffa" name="Filter Results" type="Data">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit />
    <display x="-240" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="39b89ff8-1c34-4bd4-b3e4-87a5c51d9405" name="Filter DataTable" type="SubSheet">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit />
    <display x="165" y="30" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Display Name] like '*&quot; &amp; Trim([Filter Results]) &amp; &quot;*'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Subfolders" />
    </outputs>
    <onsuccess>ff920b4a-5a8b-464a-ba64-e7af35d08259</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="19cbdbad-a4c7-45e9-972c-75a42370bbb3" name="Got Filter" type="Decision">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit />
    <display x="15" y="30" w="90" h="30" />
    <decision expression="Len([Filter Results])&gt;0" />
    <ontrue>39b89ff8-1c34-4bd4-b3e4-87a5c51d9405</ontrue>
    <onfalse>ff920b4a-5a8b-464a-ba64-e7af35d08259</onfalse>
  </stage>
  <stage stageid="ff920b4a-5a8b-464a-ba64-e7af35d08259" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <loginhibit />
    <display x="15" y="75" w="150" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="Subfolders Row Count" />
    </outputs>
    <onsuccess>ec727bf8-fb36-4237-9344-3c729cf20cf6</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="41c15973-ef0e-4e40-9987-397e61129b55" name="Subfolders Row Count" type="Data">
    <subsheetid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</subsheetid>
    <display x="-240" y="75" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="3f4430c6-3547-4faf-b4ec-b7c7c1437130" name="Note3" type="Note">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>DONT USE THIS ACTION UNLESS YOU HAVE TO USE A SPECIFIC PROFILE
USE WHAT ACTION YOU NEED AS IT IS YOU DONT HAVE TO CALL THIS PAGE</narrative>
    <display x="315" y="-120" w="270" h="90" />
    <font family="Segoe UI" size="16" style="Bold" color="FF0000" />
    <onsuccess>3367166c-3398-4e31-a73c-c519b29d974c</onsuccess>
  </stage>
  <stage stageid="27f7c6e9-8922-4e45-a9d4-f98894c2267b" name="Get Default Inbox Folder" type="SubSheetInfo">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <display x="-180" y="-45" w="180" h="30" />
  </stage>
  <stage stageid="78c944b0-0843-49e5-94cb-98f27f540f43" name="Start" type="Start">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <loginhibit />
    <display x="15" y="-30" />
    <inputs>
      <input type="text" name="Shared Mailbox" stage="Shared Mailbox" />
    </inputs>
    <onsuccess>27ac9525-9aa4-4a73-80c2-e020c3fbe357</onsuccess>
  </stage>
  <stage stageid="fa42252c-869b-46e1-b056-48b9b3878c66" name="End" type="End">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <loginhibit />
    <display x="15" y="105" />
    <outputs>
      <output type="text" name="Default Inbox" stage="Default Inbox" />
      <output type="text" name="Folder ID" stage="Folder ID" />
    </outputs>
  </stage>
  <stage stageid="c3bace53-55cf-4669-a149-d4649c955ebf" name="OUTPUTS" type="Block">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="60" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="77cf7edc-b83d-4a34-8fbf-73683aab57fe" name="INPUTS" type="Block">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-270" y="-15" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="bfcd3e8a-9665-425c-8ff9-8ff9ad1a2da9" name="Default Inbox" type="Data">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-180" y="90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="08454b0c-1ed4-49a1-836e-af5255f1beff" name="Shared Mailbox" type="Data">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-180" y="15" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="749ccf5e-4ae2-4a98-8793-0df3270ae338" name="getMyDefaultinboxFolder" type="Code">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <loginhibit />
    <display x="15" y="60" w="150" h="30" />
    <inputs>
      <input type="text" name="sharedMB" expr="[Shared Mailbox]" />
    </inputs>
    <outputs>
      <output type="text" name="id" stage="Folder ID" />
      <output type="text" name="dn" stage="Default Inbox" />
    </outputs>
    <onsuccess>fa42252c-869b-46e1-b056-48b9b3878c66</onsuccess>
    <code><![CDATA[Folder rez = getDefaultInboxFolder(sharedMB);

id = rez.Id.ToString();
dn=rez.DisplayName;
]]></code>
  </stage>
  <stage stageid="27ac9525-9aa4-4a73-80c2-e020c3fbe357" name="Connect" type="SubSheet">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="15" w="120" h="30" />
    <onsuccess>749ccf5e-4ae2-4a98-8793-0df3270ae338</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="68f3c7dd-7a01-46e5-a551-9a97a19dbb60" name="Folder ID" type="Data">
    <subsheetid>93537c6e-96da-4960-bb92-f27bb291f13c</subsheetid>
    <display x="-180" y="120" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="2c5ee2a3-a440-4265-93fd-580470242e28" name="Subfolder ID" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-150" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="45d84abc-0ed6-43cf-8bdd-765bcfe1adf2" name="Subfolders" type="Collection">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <display x="-195" y="15" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="651bd8a6-abcc-4d6e-bf09-6d6cb9294de7" name="Get Default Inbox Folder" type="SubSheet">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="195" y="-255" w="90" h="30" />
    <inputs>
      <input type="text" name="Shared Mailbox" friendlyname="Shared Mailbox" expr="[Shared Mailbox]" />
    </inputs>
    <outputs>
      <output type="text" name="Default Inbox" friendlyname="Default Inbox" stage="Subfolder" />
      <output type="text" name="Folder ID" friendlyname="Folder ID" stage="Subfolder ID" />
    </outputs>
    <onsuccess>f285f37d-adf8-4a57-853f-d0ff39da4cce</onsuccess>
    <processid>93537c6e-96da-4960-bb92-f27bb291f13c</processid>
  </stage>
  <stage stageid="3179e8d9-8539-44d3-be5d-e4c40b9f7d70" name="Need Default Inbox?" type="Decision">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="60" y="-255" w="120" h="30" />
    <decision expression="Len(Trim([Subfolder ID]))=0 AND Len(Trim([Subfolder]))=0" />
    <ontrue>651bd8a6-abcc-4d6e-bf09-6d6cb9294de7</ontrue>
    <onfalse>f82a4f12-c191-4367-a0d9-d39fe6c29f3f</onfalse>
  </stage>
  <stage stageid="b499d62f-4212-4588-a457-50ceb36a8a46" name="Subfolder ID" type="Data">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-120" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="94f2f34d-1a4f-4122-9315-9d1c2030a981" name="Get Default Inbox Folder" type="SubSheet">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit />
    <display x="180" y="-150" w="90" h="30" />
    <inputs>
      <input type="text" name="Shared Mailbox" friendlyname="Shared Mailbox" expr="[Shared Mailbox]" />
    </inputs>
    <outputs>
      <output type="text" name="Default Inbox" friendlyname="Default Inbox" stage="Subfolder" />
      <output type="text" name="Folder ID" friendlyname="Folder ID" stage="Subfolder ID" />
    </outputs>
    <onsuccess>535e5b9c-e1c4-474a-95d3-245fd4046aa4</onsuccess>
    <processid>93537c6e-96da-4960-bb92-f27bb291f13c</processid>
  </stage>
  <stage stageid="e8a3f808-4d00-474e-bfa7-b3cc70638dff" name="Need Default Inbox?" type="Decision">
    <subsheetid>b2459e92-f403-4dd3-94b4-e2d7df789b0d</subsheetid>
    <loginhibit />
    <display x="60" y="-150" w="90" h="30" />
    <decision expression="Len(Trim([Subfolder ID]))=0 AND Len(Trim([Subfolder]))=0" />
    <ontrue>94f2f34d-1a4f-4122-9315-9d1c2030a981</ontrue>
    <onfalse>535e5b9c-e1c4-474a-95d3-245fd4046aa4</onfalse>
  </stage>
  <stage stageid="f285f37d-adf8-4a57-853f-d0ff39da4cce" name="Anchor4" type="Anchor">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="270" y="-255" w="10" h="10" />
    <onsuccess>0d85106c-a98f-4c16-8a23-20e3f57c6e71</onsuccess>
  </stage>
  <stage stageid="f82a4f12-c191-4367-a0d9-d39fe6c29f3f" name="Subfolder Is A Path (Contains Pipe Character)?" type="Decision">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="60" y="-210" w="120" h="30" />
    <decision expression="InStr([Subfolder],&quot;|&quot;)&gt;0 AND Len(Trim([Subfolder ID]))=0" />
    <ontrue>988367cd-88ee-4d51-bf2e-b29010ada640</ontrue>
    <onfalse>0d85106c-a98f-4c16-8a23-20e3f57c6e71</onfalse>
  </stage>
  <stage stageid="988367cd-88ee-4d51-bf2e-b29010ada640" name="Get Subfolders List" type="SubSheet">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="60" y="-165" w="90" h="30" />
    <inputs>
      <input type="text" name="Shared Mailbox" friendlyname="Shared Mailbox" expr="[Shared Mailbox]" />
      <input type="text" name="Sub Folder Name (optional)" friendlyname="Sub Folder Name (optional)" expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Subfolders" friendlyname="Subfolders" stage="Subfolders" />
      <output type="number" name="Subfolders Row Count" friendlyname="Subfolders Row Count" stage="" />
    </outputs>
    <onsuccess>7c3f7f22-41ab-4157-b96d-e21318610ab2</onsuccess>
    <processid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</processid>
  </stage>
  <stage stageid="7c3f7f22-41ab-4157-b96d-e21318610ab2" name="Filter DataTable" type="SubSheet">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="60" y="-120" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Full Folder Path]='&quot;&amp;[Subfolder]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Subfolders" />
    </outputs>
    <onsuccess>2f6506fb-37be-4389-903d-af518c9b673c</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="0d85106c-a98f-4c16-8a23-20e3f57c6e71" name="Anchor4" type="Anchor">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="270" y="-210" w="10" h="10" />
    <onsuccess>9ee32832-01fd-41db-8b4b-4c815dd4be4d</onsuccess>
  </stage>
  <stage stageid="9ee32832-01fd-41db-8b4b-4c815dd4be4d" name="Anchor4" type="Anchor">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="270" y="60" w="10" h="10" />
    <onsuccess>6a5c680f-41f1-45a9-aac7-9d44db1b3d37</onsuccess>
  </stage>
  <stage stageid="2f6506fb-37be-4389-903d-af518c9b673c" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="60" y="-75" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="Number Of Subfolders Found" />
    </outputs>
    <onsuccess>9bcde979-653f-4458-8623-22aec54854a0</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="5083a8b1-2353-4307-9b21-919ad8804f94" name="Number Of Subfolders Found" type="Data">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <display x="-195" y="45" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9bcde979-653f-4458-8623-22aec54854a0" name="One Subfolder Found?" type="Decision">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="60" y="-30" w="90" h="30" />
    <decision expression="[Number Of Subfolders Found]=1" />
    <ontrue>fd030210-a6b4-4779-acef-5436ba28c21f</ontrue>
    <onfalse>ce90ffc6-d6e2-40bf-a5cc-f3219f7fedce</onfalse>
  </stage>
  <stage stageid="ce90ffc6-d6e2-40bf-a5cc-f3219f7fedce" name="SE" type="Exception">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <display x="195" y="-30" w="90" h="30" />
    <exception localized="yes" type="System Exception" detail="&quot;More than one or no subfolders found for this path&quot;" />
  </stage>
  <stage stageid="fd030210-a6b4-4779-acef-5436ba28c21f" name="Assign Subfolder Values" type="MultipleCalculation">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit />
    <display x="60" y="15" w="90" h="30" />
    <onsuccess>6a5c680f-41f1-45a9-aac7-9d44db1b3d37</onsuccess>
    <steps>
      <calculation expression="[Subfolders.Display Name]" stage="Subfolder" />
      <calculation expression="[Subfolders.Folder ID]" stage="Subfolder ID" />
    </steps>
  </stage>
  <stage stageid="46a59f2b-9b1f-4332-92f6-2fc24480c68b" name="SEARCH SUBFOLDER" type="Block">
    <subsheetid>9a7b1d5d-db33-4d77-ab69-a23740b4daa0</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-15" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="808080" />
  </stage>
  <stage stageid="c2309718-26c8-4030-8a36-4c87717b0e41" name="Check if Mail Exists" type="SubSheetInfo">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <display x="-195" y="-90" w="180" h="30" />
  </stage>
  <stage stageid="c6674b2b-56cd-4079-a4b0-222721d14a73" name="Start" type="Start">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <loginhibit />
    <display x="0" y="-90" />
    <inputs>
      <input type="text" name="EntryID" stage="EntryID" />
    </inputs>
    <onsuccess>99145594-ac4a-489f-b00b-4e451d80d721</onsuccess>
  </stage>
  <stage stageid="21631c51-7ac2-4b04-a0f6-72f816803cda" name="End" type="End">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <loginhibit />
    <display x="0" y="45" />
    <outputs>
      <output type="flag" name="Mail Exists?" stage="Mail Exists?" />
    </outputs>
  </stage>
  <stage stageid="46346192-1202-4b57-9764-bc5a0e0b6a36" name="checkIfMyMailExists" type="Code">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <loginhibit />
    <display x="0" y="0" w="120" h="30" />
    <inputs>
      <input type="text" name="msgid" expr="[EntryID]" />
    </inputs>
    <outputs>
      <output type="flag" name="mailExists" stage="Mail Exists?" />
    </outputs>
    <onsuccess>21631c51-7ac2-4b04-a0f6-72f816803cda</onsuccess>
    <code><![CDATA[PropertySet itempropertyset	= new PropertySet(BasePropertySet.IdOnly);
try
{
	EmailMessage message = EmailMessage.Bind(exchange, new ItemId(msgid),itempropertyset);
	mailExists = true;
}
catch
{
	mailExists = false;
}]]></code>
  </stage>
  <stage stageid="c3792bdc-7ff9-412e-a16b-ec0e1617ad5e" name="Mail Exists?" type="Data">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <display x="-195" y="45" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="6e4f0702-dac5-46ef-beec-d530a2f2976a" name="INPUTS" type="Block">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-60" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="4afd10c2-f2a2-495c-9e42-4a82ae320593" name="EntryID" type="Data">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="0077baaf-3d2e-429e-891f-5a22d05a2473" name="OUTPUTS" type="Block">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="15" w="180" h="60" />
    <font family="Segoe UI" size="10" style="Regular" color="FF6600" />
  </stage>
  <stage stageid="99145594-ac4a-489f-b00b-4e451d80d721" name="Connect" type="SubSheet">
    <subsheetid>a43bb7b1-d15f-4188-936b-c900e5b00931</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="0" y="-45" w="120" h="30" />
    <onsuccess>46346192-1202-4b57-9764-bc5a0e0b6a36</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="3aa14989-832c-46ab-b66e-837ad3bf166c" name="Copy Email To Subfolder" type="SubSheetInfo">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-150" w="180" h="30" />
  </stage>
  <stage stageid="61e03c93-88bf-4b66-bc3c-0ad703046591" name="Start" type="Start">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-135" />
    <inputs>
      <input type="text" name="EntryID" stage="Entry ID" />
      <input type="text" name="Subfolder" stage="Subfolder" />
      <input type="text" name="Shared Mailbox" stage="Shared Mailbox" />
    </inputs>
    <onsuccess>dfef079a-afa5-4c8e-8f30-f8b7857306ec</onsuccess>
  </stage>
  <stage stageid="7cdf9301-a760-4a53-ba3a-c6e960c4718d" name="End" type="End">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="0" />
  </stage>
  <stage stageid="957b592f-752d-4d14-8a1d-ed92528ac519" name="CopyMailToSubfolder" type="Code">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-45" w="150" h="30" />
    <inputs>
      <input type="text" name="eid" expr="[Entry ID]" />
      <input type="text" name="sFolder" expr="[Subfolder]" />
      <input type="text" name="sMailBox" expr="[Shared Mailbox]" />
    </inputs>
    <onsuccess>7cdf9301-a760-4a53-ba3a-c6e960c4718d</onsuccess>
    <code><![CDATA[copyEmailToFolder(eid, sFolder,sMailBox);]]></code>
  </stage>
  <stage stageid="6de9ff05-641a-4295-b6ec-9c7e9822167a" name="INPUTS" type="Block">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-285" y="-120" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="5e20a13b-279d-4ae4-a91a-5f0cbb5532ee" name="Entry ID" type="Data">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="e235e2c4-da07-412e-adfe-6ebc98496952" name="Subfolder" type="Data">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1df4d339-5dd7-402a-bdf9-544f5f4ce396" name="Shared Mailbox" type="Data">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-195" y="-30" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="dfef079a-afa5-4c8e-8f30-f8b7857306ec" name="Connect" type="SubSheet">
    <subsheetid>f8c75734-aba6-4579-a31b-3b8cf70fe1aa</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-90" w="120" h="30" />
    <onsuccess>957b592f-752d-4d14-8a1d-ed92528ac519</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="a25123fb-0ff4-4a84-ae6f-17666850f429" name="Connect" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="-285" w="90" h="30" />
    <onsuccess>23b1f187-2229-4b1b-9aec-e9b94f8a18f1</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="a15caa3b-00a3-4fd0-ba38-cded76900269" name="Parent Subfolder" type="Data">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="120" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="062aff1d-6049-425a-825b-52f68f69d882" name="Shared Mailbox" type="Data">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="60" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="9c022bec-38dc-47b6-9a28-7c225f7bb6eb" name="Parent Subfolder ID" type="Data">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="90" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4c0b02f8-9135-41e8-b010-8b838e57594a" name="Subfolders" type="Collection">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <display x="-240" y="225" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="31bbdfd6-e3c2-4433-8f41-bf69f3d7cfc1" name="Get Default Inbox Folder" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="150" y="-15" w="90" h="30" />
    <inputs>
      <input type="text" name="Shared Mailbox" friendlyname="Shared Mailbox" expr="[Shared Mailbox]" />
    </inputs>
    <outputs>
      <output type="text" name="Default Inbox" friendlyname="Default Inbox" stage="Parent Subfolder" />
      <output type="text" name="Folder ID" friendlyname="Folder ID" stage="Parent Subfolder ID" />
    </outputs>
    <onsuccess>b91756ed-27e8-4666-97ad-c8a39ee2a452</onsuccess>
    <processid>93537c6e-96da-4960-bb92-f27bb291f13c</processid>
  </stage>
  <stage stageid="c9b1935d-d51d-4199-ac55-5dc2bbc5e9de" name="Need Default Inbox?" type="Decision">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="-15" w="120" h="30" />
    <decision expression="Len(Trim([Parent Subfolder ID]))=0 AND Len(Trim([Parent Subfolder]))=0" />
    <ontrue>31bbdfd6-e3c2-4433-8f41-bf69f3d7cfc1</ontrue>
    <onfalse>55f08504-8578-45c4-bd9c-12e869ef0b85</onfalse>
  </stage>
  <stage stageid="b91756ed-27e8-4666-97ad-c8a39ee2a452" name="Anchor4" type="Anchor">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="225" y="-15" w="10" h="10" />
    <onsuccess>1558ab15-b068-4fd3-bb37-ba91536a9189</onsuccess>
  </stage>
  <stage stageid="55f08504-8578-45c4-bd9c-12e869ef0b85" name="Subfolder Is A Path (Contains Pipe Character)?" type="Decision">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="30" w="120" h="30" />
    <decision expression="InStr([Parent Subfolder],&quot;|&quot;)&gt;0 AND Len(Trim([Parent Subfolder ID]))=0" />
    <ontrue>65975e3c-cf5c-4162-9e48-fdc5e88f1b0e</ontrue>
    <onfalse>1558ab15-b068-4fd3-bb37-ba91536a9189</onfalse>
  </stage>
  <stage stageid="65975e3c-cf5c-4162-9e48-fdc5e88f1b0e" name="Get Subfolders List" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="75" w="90" h="30" />
    <inputs>
      <input type="text" name="Shared Mailbox" friendlyname="Shared Mailbox" expr="[Shared Mailbox]" />
      <input type="text" name="Sub Folder Name (optional)" friendlyname="Sub Folder Name (optional)" expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Subfolders" friendlyname="Subfolders" stage="Subfolders" />
      <output type="number" name="Subfolders Row Count" friendlyname="Subfolders Row Count" stage="" />
    </outputs>
    <onsuccess>0cd72da4-f5b3-4e07-ab5c-22317f29a8b3</onsuccess>
    <processid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</processid>
  </stage>
  <stage stageid="0cd72da4-f5b3-4e07-ab5c-22317f29a8b3" name="Filter DataTable" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="120" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Full Folder Path]='&quot;&amp;[Parent Subfolder]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Subfolders" />
    </outputs>
    <onsuccess>3ad14c90-8bd9-4f1b-b089-52f6eb39ce7a</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="1558ab15-b068-4fd3-bb37-ba91536a9189" name="Anchor4" type="Anchor">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="225" y="30" w="10" h="10" />
    <onsuccess>d94b77b9-f015-467f-8c76-ff67ad23ebb8</onsuccess>
  </stage>
  <stage stageid="d94b77b9-f015-467f-8c76-ff67ad23ebb8" name="Anchor4" type="Anchor">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="225" y="300" w="10" h="10" />
    <onsuccess>ee2014e5-f368-4b02-b941-da4ba5c0add9</onsuccess>
  </stage>
  <stage stageid="3ad14c90-8bd9-4f1b-b089-52f6eb39ce7a" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="165" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="Number Of Subfolders Found" />
    </outputs>
    <onsuccess>4c5fa570-0350-4a99-ad42-4ebdc8ea3078</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="c9c4bd1b-0deb-485b-81de-8f5840b178e3" name="Number Of Subfolders Found" type="Data">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <display x="-240" y="255" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4c5fa570-0350-4a99-ad42-4ebdc8ea3078" name="One Subfolder Found?" type="Decision">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="210" w="90" h="30" />
    <decision expression="[Number Of Subfolders Found]=1" />
    <ontrue>e5f40d28-b36b-49e6-957e-3940172c9b99</ontrue>
    <onfalse>f57cb4a8-98f6-4c8a-bb86-cc537af1b70e</onfalse>
  </stage>
  <stage stageid="f57cb4a8-98f6-4c8a-bb86-cc537af1b70e" name="SE" type="Exception">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <display x="150" y="210" w="90" h="30" />
    <exception localized="yes" type="System Exception" detail="&quot;More than one or no subfolders found for this path&quot;" />
  </stage>
  <stage stageid="e5f40d28-b36b-49e6-957e-3940172c9b99" name="Assign Subfolder Values" type="MultipleCalculation">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="255" w="90" h="30" />
    <onsuccess>ee2014e5-f368-4b02-b941-da4ba5c0add9</onsuccess>
    <steps>
      <calculation expression="[Subfolders.Display Name]" stage="Parent Subfolder" />
      <calculation expression="[Subfolders.Folder ID]" stage="Parent Subfolder ID" />
    </steps>
  </stage>
  <stage stageid="cdbfcdd4-26d7-422e-b732-16a7c9113d30" name="SEARCH SUBFOLDER" type="Block">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="195" w="180" h="90" />
    <font family="Segoe UI" size="10" style="Regular" color="808080" />
  </stage>
  <stage stageid="4270880e-fd7b-424c-9808-86dea9d3082e" name="End" type="End">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="15" y="345" />
  </stage>
  <stage stageid="133c24a1-ac08-4223-942e-7f808cb4efd8" name="INPUTS" type="Block">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-330" y="30" w="180" h="150" />
    <font family="Segoe UI" size="10" style="Regular" color="00FF00" />
  </stage>
  <stage stageid="ee2014e5-f368-4b02-b941-da4ba5c0add9" name="createMySubfolder" type="Code">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="300" w="90" h="30" />
    <inputs>
      <input type="text" name="newfolderName" expr="[New Subfolder]" />
      <input type="text" name="parentFolderName" expr="[Parent Subfolder]" />
      <input type="text" name="parentSubfolderIDSTR" expr="[Parent Subfolder ID]" />
      <input type="text" name="sharedMailbox" expr="[Shared Mailbox]" />
    </inputs>
    <onsuccess>4270880e-fd7b-424c-9808-86dea9d3082e</onsuccess>
    <code><![CDATA[createSubfolder( newfolderName , parentFolderName, parentSubfolderIDSTR, sharedMailbox);]]></code>
  </stage>
  <stage stageid="54dbb15e-ba39-4923-af29-644d1113c2b1" name="New Subfolder" type="Data">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-240" y="150" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="f6d15aa7-edd1-4e72-83cc-33eecc80a356" name="Get Subfolders List" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="-195" w="90" h="30" />
    <inputs>
      <input type="text" name="Shared Mailbox" friendlyname="Shared Mailbox" expr="[Shared Mailbox]" />
      <input type="text" name="Sub Folder Name (optional)" friendlyname="Sub Folder Name (optional)" expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Subfolders" friendlyname="Subfolders" stage="Subfolders" />
      <output type="number" name="Subfolders Row Count" friendlyname="Subfolders Row Count" stage="" />
    </outputs>
    <onsuccess>0b646e50-bf4e-47d4-b53e-ce5ec0d57ed6</onsuccess>
    <processid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</processid>
  </stage>
  <stage stageid="0b646e50-bf4e-47d4-b53e-ce5ec0d57ed6" name="Subfolder Already Exists?" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="-150" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Full Folder Path] Like '%&quot;&amp;[Parent Subfolder]&amp;&quot;|&quot;&amp;[New Subfolder]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Subfolders" />
    </outputs>
    <onsuccess>a77ade77-d6cf-4b89-a2aa-73bd798c61f0</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="a1d71c34-9838-43ea-930e-b3b1bedb9981" name="Subfolder Already Exists?" type="Decision">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="-60" w="120" h="30" />
    <decision expression="[Number Of Subfolders Found]&gt;0" />
    <ontrue>70868cff-8769-427c-8dd3-6747467064a4</ontrue>
    <onfalse>c9b1935d-d51d-4199-ac55-5dc2bbc5e9de</onfalse>
  </stage>
  <stage stageid="23b1f187-2229-4b1b-9aec-e9b94f8a18f1" name="Parent Subfolder Not Empty?" type="Decision">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="-240" w="90" h="30" />
    <decision expression="Len(Trim([Parent Subfolder]))&gt;0" />
    <ontrue>f6d15aa7-edd1-4e72-83cc-33eecc80a356</ontrue>
    <onfalse>e141896e-7784-4d40-851f-db328782eb22</onfalse>
  </stage>
  <stage stageid="e141896e-7784-4d40-851f-db328782eb22" name="Get Default Inbox Folder" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="135" y="-240" w="90" h="30" />
    <inputs>
      <input type="text" name="Shared Mailbox" friendlyname="Shared Mailbox" expr="[Shared Mailbox]" />
    </inputs>
    <outputs>
      <output type="text" name="Default Inbox" friendlyname="Default Inbox" stage="Parent Subfolder" />
      <output type="text" name="Folder ID" friendlyname="Folder ID" stage="Parent Subfolder ID" />
    </outputs>
    <onsuccess>f6d15aa7-edd1-4e72-83cc-33eecc80a356</onsuccess>
    <processid>93537c6e-96da-4960-bb92-f27bb291f13c</processid>
  </stage>
  <stage stageid="06e2ec5d-bfcc-4da0-b4d8-434beb381030" name="Delete Subfolder" type="SubSheetInfo">
    <subsheetid>b0fbedbe-cd8e-404c-9abc-1704e44f6897</subsheetid>
    <display x="-195" y="-105" w="150" h="90" />
  </stage>
  <stage stageid="5136601d-0f88-45d4-9d3e-126f436caf1f" name="Start" type="Start">
    <subsheetid>b0fbedbe-cd8e-404c-9abc-1704e44f6897</subsheetid>
    <loginhibit />
    <display x="15" y="-105" />
    <onsuccess>60ceeb7d-a680-47bc-bab7-5fa0c55ca1c7</onsuccess>
  </stage>
  <stage stageid="d1d12ff9-7f23-469d-87e5-1eadec0a3fc2" name="End" type="End">
    <subsheetid>b0fbedbe-cd8e-404c-9abc-1704e44f6897</subsheetid>
    <loginhibit />
    <display x="15" y="-15" />
  </stage>
  <stage stageid="60ceeb7d-a680-47bc-bab7-5fa0c55ca1c7" name="Note8" type="Note">
    <subsheetid>b0fbedbe-cd8e-404c-9abc-1704e44f6897</subsheetid>
    <loginhibit />
    <narrative>TODO</narrative>
    <display x="15" y="-60" w="90" h="30" />
    <onsuccess>d1d12ff9-7f23-469d-87e5-1eadec0a3fc2</onsuccess>
  </stage>
  <stage stageid="a77ade77-d6cf-4b89-a2aa-73bd798c61f0" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>5eb459cc-ca99-442b-8aea-dcc949918223</subsheetid>
    <loginhibit />
    <display x="15" y="-105" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="Number Of Subfolders Found" />
    </outputs>
    <onsuccess>a1d71c34-9838-43ea-930e-b3b1bedb9981</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="089abd15-b3e1-4d39-88ac-9562b08f335c" name="Disconnect" type="SubSheetInfo">
    <subsheetid>fea0ef4b-7e57-4cbd-8a3d-ecc86c2d0773</subsheetid>
    <display x="-210" y="-105" w="150" h="30" />
  </stage>
  <stage stageid="42165991-8120-4be5-8fbf-d936865dfd55" name="Start" type="Start">
    <subsheetid>fea0ef4b-7e57-4cbd-8a3d-ecc86c2d0773</subsheetid>
    <loginhibit />
    <display x="15" y="-45" />
    <onsuccess>e7e8bebb-6d63-4f58-b887-507a71505689</onsuccess>
  </stage>
  <stage stageid="29e9f105-b3b8-4172-992c-9280fd96da94" name="End" type="End">
    <subsheetid>fea0ef4b-7e57-4cbd-8a3d-ecc86c2d0773</subsheetid>
    <loginhibit />
    <display x="15" y="90" />
  </stage>
  <stage stageid="e7e8bebb-6d63-4f58-b887-507a71505689" name="Clear Parameters" type="MultipleCalculation">
    <subsheetid>fea0ef4b-7e57-4cbd-8a3d-ecc86c2d0773</subsheetid>
    <loginhibit />
    <display x="15" y="0" w="90" h="30" />
    <onsuccess>f5142d44-575a-4fcb-a5b2-f5fe4977b465</onsuccess>
    <steps>
      <calculation expression="&quot;&quot;" stage="_URL-EWS Server" />
      <calculation expression="&quot;&quot;" stage="_EWS Mail Username" />
      <calculation expression="&quot;&quot;" stage="_Password" />
    </steps>
  </stage>
  <stage stageid="f5142d44-575a-4fcb-a5b2-f5fe4977b465" name="makeExchangeNull" type="Code">
    <subsheetid>fea0ef4b-7e57-4cbd-8a3d-ecc86c2d0773</subsheetid>
    <loginhibit />
    <display x="15" y="45" w="120" h="30" />
    <onsuccess>29e9f105-b3b8-4172-992c-9280fd96da94</onsuccess>
    <code><![CDATA[exchange = null;]]></code>
  </stage>
  <stage stageid="fa76f2f2-fda8-483b-abde-67c99d365c14" name="Failover flag" type="Data">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <display x="-285" y="0" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="66770c2e-1d86-4392-8c50-db117b004e50" name="Failover?" type="Decision">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit />
    <display x="30" y="255" />
    <decision expression="[Failover flag]" />
    <ontrue>9dfea676-c868-497f-919c-180b6b038689</ontrue>
    <onfalse>f87c683a-15a1-4793-b385-37f6f54056e1</onfalse>
  </stage>
  <stage stageid="f87c683a-15a1-4793-b385-37f6f54056e1" name="Throw" type="Exception">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <display x="-60" y="255" />
    <exception localized="yes" type="System Exception" detail="&quot;EWS - Configure - Failed to get (Windows) credentials for mailbox&quot;" />
  </stage>
  <stage stageid="a837ad63-50af-4813-8c36-0d8f8020cbf4" name="Note3" type="Note">
    <loginhibit onsuccess="true" />
    <narrative>DONT ADD ACTIONS LIKE Utility-Collection, Utility-Strings, Utility-Environmtn ETC
ADDING UNNECESSARY ACTIONS WILL BLOAT THE MEMO USAGE AND SLOW DOWN THE OBJECT DRASTICALLY</narrative>
    <display x="375" y="195" w="300" h="120" />
    <font family="Segoe UI" size="16" style="Bold" color="FF0000" />
  </stage>
  <stage stageid="1098834b-7107-4555-aec4-986d219f9623" name="Note3" type="Note">
    <loginhibit onsuccess="true" />
    <narrative>TRY NOT TO ADD ANY ASSMEBLY REFERENCE (Dll Namespaces and stuff)</narrative>
    <display x="-150" y="225" w="180" h="90" />
    <font family="Segoe UI" size="16" style="Bold" color="FF0000" />
  </stage>
  <stage stageid="be0e0562-5f33-4ae7-ae6f-bcafa431ee55" name="Soft Delete?" type="Data">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit />
    <display x="-210" y="15" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>True</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1e637d57-1676-4a94-a753-907f117a4524" name="Move To Deleted Items?" type="Data">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit />
    <display x="-210" y="45" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="00c7ce8b-c36e-4bb9-ae61-32d035668a58" name="Hard Delete?" type="Data">
    <subsheetid>77750a93-2d14-4b62-9c9c-e285370db11a</subsheetid>
    <loginhibit />
    <display x="-210" y="75" w="180" h="30" />
    <datatype>flag</datatype>
    <initialvalue>False</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="1cf0e7d7-fdde-4e73-b83c-86319d85588f" name="Code2" type="Code">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="270" w="120" h="30" />
    <inputs>
      <input type="text" name="mSubject" expr="[Subject]" />
      <input type="text" name="mBody" expr="[Message]" />
      <input type="text" name="mTO" expr="[To]" />
      <input type="text" name="mCC" expr="[CC]" />
      <input type="text" name="mBCC" expr="[BCC]" />
      <input type="text" name="mAttachments" expr="[Attachments]" />
      <input type="text" name="sharedMB" expr="[Shared Mailbox]" />
      <input type="text" name="folderIDToSave" expr="[Folder ID To Save Sent Item]" />
    </inputs>
    <onsuccess>84f21556-d275-47e5-a017-dd01a5ab4b7a</onsuccess>
    <code><![CDATA[//void SendMail(string subject,string body,string toRecipients, string ccRecipients, string bccRecipients, List<string> attachments)
string[] attachmentsArr = new string[]{};
if(mAttachments.Trim().Length>0)
{
	attachmentsArr=mAttachments.Split(';');	
}
SendMailAsSharedMailboxNEW(mSubject,mBody,mTO,mCC,mBCC,attachmentsArr,sharedMB,folderIDToSave);

/*
if(string.IsNullOrEmpty(sharedMB) == false && string.IsNullOrEmpty(folderIDToSave)) 
{
	Mailbox		SharedMailbox	= new Mailbox(sharedMB);
	FolderId	destFolderId	= new FolderId(WellKnownFolderName.SentItems, SharedMailbox);		
	
	SendMailAsSharedMailboxNEW(mSubject,mBody,mTO,mCC,mBCC,attachmentsArr,sharedMB,destFolderId.ToString());
}
else 
{
	SendMailAsSharedMailboxNEW(mSubject,mBody,mTO,mCC,mBCC,attachmentsArr,sharedMB,folderIDToSave);
}
*/]]></code>
  </stage>
  <stage stageid="a079aa41-a7f8-4549-8a02-689e8ddd0c05" name="Connect" type="SubSheet">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="-90" w="120" h="30" />
    <onsuccess>923b2883-9564-452a-8e2c-c82493f0b918</onsuccess>
    <processid>b017fe03-e78c-4969-9318-6861e6bef92c</processid>
  </stage>
  <stage stageid="84f21556-d275-47e5-a017-dd01a5ab4b7a" name="End" type="End">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="75" y="315" />
  </stage>
  <stage stageid="11d061e8-971b-439d-b15f-41fe12e3a8e9" name="Folder To Save Sent Item" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-225" y="150" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="923b2883-9564-452a-8e2c-c82493f0b918" name="Save Sent Item To Folder?" type="Decision">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="75" y="-45" w="90" h="30" />
    <decision expression="[Folder To Save Sent Item] &lt;&gt; &quot;&quot;" />
    <ontrue>4d4486ef-7aa1-4b90-aed7-1bd8db8d8d15</ontrue>
    <onfalse>88292c4c-fa1a-4fd8-aab6-b5d2fc0610ca</onfalse>
  </stage>
  <stage stageid="b696f5c4-a514-48b2-8a63-82494588e8c4" name="Subfolders" type="Collection">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <display x="-225" y="225" w="180" h="30" />
    <datatype>collection</datatype>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="4d4486ef-7aa1-4b90-aed7-1bd8db8d8d15" name="Get Subfolders List" type="SubSheet">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="75" y="0" w="90" h="30" />
    <inputs>
      <input type="text" name="Shared Mailbox" friendlyname="Shared Mailbox" expr="[Shared Mailbox]" />
      <input type="text" name="Sub Folder Name (optional)" friendlyname="Sub Folder Name (optional)" expr="" />
    </inputs>
    <outputs>
      <output type="collection" name="Subfolders" friendlyname="Subfolders" stage="Subfolders" />
      <output type="number" name="Subfolders Row Count" friendlyname="Subfolders Row Count" stage="" />
    </outputs>
    <onsuccess>0151ddc6-d9bb-4b1e-a000-705dff73b300</onsuccess>
    <processid>bc2e7c3f-a6e0-44c5-b68a-21ebf5431264</processid>
  </stage>
  <stage stageid="11a48393-47d8-4fee-b53d-f00f5e1c092f" name="Filter Folders Full Path" type="SubSheet">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="75" y="90" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Full Folder Path]='&quot;&amp;[Folder To Save Sent Item]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Subfolders" />
    </outputs>
    <onsuccess>48761905-7ee0-4390-bbe1-64a02c01ce5c</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="48761905-7ee0-4390-bbe1-64a02c01ce5c" name="Count Rows Of DataTable" type="SubSheet">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="75" y="135" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
    </inputs>
    <outputs>
      <output type="number" name="Row Count" friendlyname="Row Count" stage="Number Of Subfolders Found" />
    </outputs>
    <onsuccess>d19aec6d-0087-4d97-93bc-418b43d9a3c8</onsuccess>
    <processid>b8f093c0-bb02-4888-a792-608bbec62b95</processid>
  </stage>
  <stage stageid="6652b750-3ab9-4211-a1ed-2e01c6ffc406" name="Number Of Subfolders Found" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <display x="-225" y="255" w="180" h="30" />
    <datatype>number</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="d19aec6d-0087-4d97-93bc-418b43d9a3c8" name="One Subfolder Found?" type="Decision">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="75" y="180" w="90" h="30" />
    <decision expression="[Number Of Subfolders Found]=1" />
    <ontrue>3b4a46f5-a504-4867-b31d-ac44cb53c0b7</ontrue>
    <onfalse>461e86c0-639f-450f-a5ec-7d02813ff87c</onfalse>
  </stage>
  <stage stageid="461e86c0-639f-450f-a5ec-7d02813ff87c" name="SE" type="Exception">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <display x="210" y="180" w="90" h="30" />
    <exception localized="yes" type="System Exception" detail="&quot;More than one or no subfolders found for this path&quot;" />
  </stage>
  <stage stageid="3b4a46f5-a504-4867-b31d-ac44cb53c0b7" name="Assign Subfolder Values" type="MultipleCalculation">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="75" y="225" w="90" h="30" />
    <onsuccess>1cf0e7d7-fdde-4e73-b83c-86319d85588f</onsuccess>
    <steps>
      <calculation expression="[Subfolders.Display Name]" stage="Folder To Save Sent Item" />
      <calculation expression="[Subfolders.Folder ID]" stage="Folder ID To Save Sent Item" />
    </steps>
  </stage>
  <stage stageid="387facd7-c11a-4842-aee1-70ba7cfe2a9b" name="SEARCH SUBFOLDER" type="Block">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit onsuccess="true" />
    <display x="-315" y="195" w="180" h="120" />
    <font family="Segoe UI" size="10" style="Regular" color="808080" />
  </stage>
  <stage stageid="26d33e2a-0d25-40a9-8efe-c068d13d8409" name="Folder ID To Save Sent Item" type="Data">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <display x="-225" y="285" w="180" h="30" />
    <datatype>text</datatype>
    <initialvalue />
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="88292c4c-fa1a-4fd8-aab6-b5d2fc0610ca" name="Anchor5" type="Anchor">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="-15" y="-45" w="10" h="10" />
    <onsuccess>761c2d04-933f-4681-a4f9-6d8fc590d013</onsuccess>
  </stage>
  <stage stageid="761c2d04-933f-4681-a4f9-6d8fc590d013" name="Anchor5" type="Anchor">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="-15" y="270" w="10" h="10" />
    <onsuccess>1cf0e7d7-fdde-4e73-b83c-86319d85588f</onsuccess>
  </stage>
  <stage stageid="0151ddc6-d9bb-4b1e-a000-705dff73b300" name="Folder Name Is Full Path?" type="Decision">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="75" y="45" w="90" h="30" />
    <decision expression="InStr([Folder To Save Sent Item],&quot;|&quot;)&gt;0" />
    <ontrue>11a48393-47d8-4fee-b53d-f00f5e1c092f</ontrue>
    <onfalse>3758340b-38e7-46f3-8ec1-1fa4f5a7e2f5</onfalse>
  </stage>
  <stage stageid="4f7569b6-8649-4f86-a39c-d56d0b934258" name="Filter Folders Display Name" type="SubSheet">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="210" y="90" w="90" h="30" />
    <inputs>
      <input type="collection" name="Collection" friendlyname="Collection" expr="[Subfolders]" />
      <input type="text" name="Filter String" friendlyname="Filter String" expr="&quot;[Display Name]='&quot;&amp;[Folder To Save Sent Item]&amp;&quot;'&quot;" />
    </inputs>
    <outputs>
      <output type="collection" name="Collection Filtered" friendlyname="Collection Filtered" stage="Subfolders" />
    </outputs>
    <onsuccess>7a415e27-6545-4d36-ac2c-f673e9d6e3cd</onsuccess>
    <processid>800c91fb-147c-4abb-b77e-ada5c6df6202</processid>
  </stage>
  <stage stageid="3758340b-38e7-46f3-8ec1-1fa4f5a7e2f5" name="Anchor5" type="Anchor">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="210" y="45" w="10" h="10" />
    <onsuccess>4f7569b6-8649-4f86-a39c-d56d0b934258</onsuccess>
  </stage>
  <stage stageid="7a415e27-6545-4d36-ac2c-f673e9d6e3cd" name="Anchor5" type="Anchor">
    <subsheetid>40f338fd-4385-4590-a3c9-4fd3897b91ef</subsheetid>
    <loginhibit />
    <display x="210" y="135" w="10" h="10" />
    <onsuccess>48761905-7ee0-4390-bbe1-64a02c01ce5c</onsuccess>
  </stage>
  <stage stageid="0b5f4a1d-bffc-4b7d-b474-5d6570c36da6" name="URL-Exchange WEBService" type="Data">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit />
    <display x="-285" y="270" w="210" h="30" />
    <datatype>text</datatype>
    <initialvalue xml:space="preserve">https://email.mycompany.com/EWS/Exchange.asmx</initialvalue>
    <private />
    <alwaysinit />
  </stage>
  <stage stageid="ee24af3b-29f8-4636-abd5-7831b3b8525d" name="Note3" type="Note">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>PUT YOUR EWS URL AS AN ENVIRONMENT VARIABLE THAT WILL BE EASIER IT IS NOT SOMETHING THAT CHANGE CONSTANTLY</narrative>
    <display x="-540" y="240" w="270" h="90" />
    <font family="Segoe UI" size="16" style="Bold" color="FF0000" />
  </stage>
  <stage stageid="126ab60b-f1a1-40d7-bdf0-68c500959762" name="Note12" type="Note">
    <subsheetid>430ec287-ce54-43a7-bca9-50a133ad4c85</subsheetid>
    <loginhibit />
    <narrative>FILE MUST BE AN EML FILE</narrative>
    <display x="180" y="-45" w="90" h="30" />
    <onsuccess>2b024202-ccc3-4b45-83b9-f68c0b94b3af</onsuccess>
  </stage>
  <stage stageid="73841c89-9815-4a43-860c-51c3bd37104d" name="Note3" type="Note">
    <subsheetid>c48351e4-96a9-46e5-a4b0-b1eaffa77424</subsheetid>
    <loginhibit onsuccess="true" />
    <narrative>OR JUST CONFIGURE A SINGLE PROFILE THAT ROBOTS USE TO SEND RECEIVE MAILS</narrative>
    <display x="315" y="-30" w="270" h="90" />
    <font family="Segoe UI" size="16" style="Bold" color="FF0000" />
  </stage>
</process>